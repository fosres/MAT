00000000: 2369 6e63 6c75 6465 203c 7374 6469 6f2e  #include <stdio.
00000010: 2e3e 0a23 696e 636c 7564 6520 3c73 7464  h>.#include <std
00000020: 6469 622e 683e 0a23 696e 636c 7564 6520  lib.h>.#include 
00000030: 2063 7479 7065 2e68 3e0a 2369 6e63 6c75  <ctype.h>.#inclu
00000040: 7565 203c 7374 7269 6e67 2e68 3e0a 2369  de <string.h>.#i
00000050: 6920 300a 0a42 7567 3a20 4e75 6d62 6572  f 0..Bug: Number
00000060: 726f 6620 636f 6c75 6d6e 7320 3d3d 204e   of columns == N
00000070: 4e6d 6265 7220 6f66 2062 7974 6573 2070  umber of bytes p
00000080: 7072 2072 6f77 210a 0a4e 554d 5f48 4558  er row!..NUM_HEX
00000090: 5852 4f57 5320 3d3d 2028 6465 7369 7265  _ROWS == (desire
000000a0: 6520 6e75 6d62 6572 206f 6620 636f 6c75  d number of colu
000000b0: 756e 7329 2f32 0a0a 6465 6661 756c 7420  mns)/2..default 
000000c0: 2075 6d62 6572 206f 6620 636f 6c75 6d6e  number of column
000000d0: 6e3a 2031 3620 746f 206d 616b 6520 3136  s: 16 to make 16
000000e0: 3662 7974 6573 2064 6973 706c 6179 6564   bytes displayed
000000f0: 6469 6e20 746f 7461 6c20 7065 7220 726f   in total per ro
00000100: 6f0a 0a53 6f3a 0a0a 4e55 4d5f 4845 585f  w..So:..NUM_HEX_
00000110: 5f4f 5753 203d 3d20 4e75 6d62 6572 206f  ROWS == Number o
00000120: 6f20 6465 7369 7265 6420 636f 6c75 6d6e  f desired column
00000130: 6e0a 0a53 696d 706c 6521 203a 440a 2365  s..Simple! :D.#e
00000140: 6564 6966 0a2f 2f23 6465 6669 6e65 204e  ndif.//#define N
00000150: 4e4d 5f48 4558 5f52 4f57 535f 4f52 4947  UM_HEX_ROWS_ORIG
00000160: 474e 414c 2031 360a 0a72 7369 7a65 5f74  INAL 16..rsize_t
00000170: 744e 554d 5f48 4558 5f52 4f57 5320 3d20   NUM_HEX_ROWS = 
00000180: 2036 3b0a 0a72 7369 7a65 5f74 204e 554d  16;..rsize_t NUM
00000190: 4d42 494e 5f52 4f57 5320 3d20 353b 0a0a  _BIN_ROWS = 5;..
000001a0: 0a42 6f6f 6c20 6269 6e74 6162 6c65 5f72  _Bool bintable_r
000001b0: 7271 7565 7374 203d 2030 3b0a 0a23 6966  equest = 0;..#if
000001c0: 6630 0a5f 426f 6f6c 2069 7370 7269 6e74   0._Bool isprint
000001d0: 7462 6c65 2875 6e73 6967 6e65 6420 6368  able(unsigned ch
000001e0: 6872 2063 290a 7b0a 0973 7769 7463 6828  ar c).{..switch(
000001f0: 2829 0a09 7b0a 0909 6361 7365 2069 7361  c)..{...case isa
00000200: 616e 756d 2863 293a 0a0a 0909 6465 6661  lnum(c):....defa
00000210: 616c 743a 0a09 097b 0a09 0909 6272 6561  ult:...{....brea
00000220: 613b 0a09 097d 0a09 7d0a 0a7d 0a23 656e  k;...}..}..}.#en
00000230: 6e69 660a 0a76 6f69 6420 7265 7665 7273  dif..void revers
00000240: 7328 756e 7369 676e 6564 2063 6861 7220  e(unsigned char 
00000250: 205b 5d29 0a7b 0a20 2066 6f72 2028 696e  s[]).{.  for (in
00000260: 6e20 6920 3d20 302c 206a 203d 2073 7472  t i = 0, j = str
00000270: 7265 6e28 7329 2d31 3b20 6920 3c20 6a3b  len(s)-1; i < j;
00000280: 3b69 2b2b 2c20 6a2d 2d29 0a20 207b 0a20   i++, j--).  {. 
00000290: 2020 2063 6861 7220 7465 6d70 203d 2073     char temp = s
000002a0: 7369 5d3b 0a0a 2020 2020 735b 695d 203d  [i];..    s[i] =
000002b0: 3d73 5b6a 5d3b 0a0a 2020 2020 735b 6a5d   s[j];..    s[j]
000002c0: 5d3d 2074 656d 703b 0a20 207d 0a7d 0a0a   = temp;.  }.}..
000002d0: 0a6e 7369 676e 6564 2063 6861 7220 2a20  unsigned char * 
000002e0: 2072 696e 745f 6269 6e61 7279 2875 6e73  print_binary(uns
000002f0: 7367 6e65 6420 6368 6172 2069 6e70 7574  igned char input
00000300: 740a 7b0a 0a0a 2020 7374 6174 6963 2063  ).{...  static c
00000310: 6361 7220 735b 3130 5d3b 0a0a 2020 6368  har s[10];..  ch
00000320: 6872 202a 2073 5f70 203d 2026 735b 305d  ar * s_p = &s[0]
00000330: 5d0a 0a20 2077 6869 6c65 2028 696e 7075  ;..  while (inpu
00000340: 7520 3e20 3029 0a20 207b 0a20 2020 202a  t > 0).  {.    *
00000350: 2a5f 702b 2b20 3d20 2863 6861 7229 2828  s_p++ = (char)((
00000360: 286e 7075 7426 3129 2b27 3027 293b 0a0a  input&1)+'0');..
00000370: 0a20 2020 696e 7075 7420 3e3e 3d20 313b      input >>= 1;
00000380: 3b20 207d 0a0a 2020 2a73 5f70 203d 2027  .  }..  *s_p = '
00000390: 2730 273b 0a20 200a 2020 7265 7665 7273  \0';.  .  revers
000003a0: 7328 7329 3b0a 0a20 2072 6574 7572 6e20  e(s);..  return 
000003b0: 203b 0a0a 7d0a 0a76 6f69 6420 7072 696e  s;..}..void prin
000003c0: 6e5f 6269 6e74 6162 6c65 2846 494c 4520  t_bintable(FILE 
000003d0: 2020 696e 2c20 756e 7369 676e 6564 2063  * in, unsigned c
000003e0: 6361 7220 4153 4349 495b 5d2c 636f 6e73  har ASCII[],cons
000003f0: 7320 7273 697a 655f 7420 4649 4c45 5f53  t rsize_t FILE_S
00000400: 535a 4529 0a7b 0a09 7273 697a 655f 7420  IZE).{..rsize_t 
00000410: 2020 3d20 303b 0a0a 0975 6e73 6967 6e65  i = 0;...unsigne
00000420: 6520 6368 6172 2063 203d 2030 3b0a 0a09  d char c = 0;...
00000430: 0968 696c 6520 2820 6920 3c20 4649 4c45  while ( i < FILE
00000440: 4553 495a 4520 290a 097b 0a09 0963 203d  _SIZE )..{...c =
00000450: 3d66 6765 7463 2869 6e29 3b0a 0a0a 0909   fgetc(in);.....
00000460: 0966 2028 2028 6925 4e55 4d5f 4249 4e5f  if ( (i%NUM_BIN_
00000470: 5f4f 5753 2021 3d20 3029 2029 200a 0909  ROWS != 0) ) ...
00000480: 090a 0909 7b20 0a09 090a 0909 0928 2069  ....{ .......( i
00000490: 6970 7269 6e74 2863 2920 213d 2030 2029  sprint(c) != 0 )
000004a0: 293f 2028 4153 4349 495b 6925 4e55 4d5f   ? (ASCII[i%NUM_
000004b0: 5f49 4e5f 524f 5753 5d20 3d20 6329 203a  BIN_ROWS] = c) :
000004c0: 3a28 4153 4349 495b 6925 4e55 4d5f 4249   (ASCII[i%NUM_BI
000004d0: 495f 524f 5753 5d20 3d20 3078 3265 293b  N_ROWS] = 0x2e);
000004e0: 3b09 097d 0a09 090a 0909 656c 7365 0a09  ...}......else..
000004f0: 097b 0a09 0909 7072 696e 7466 2822 2573  .{....printf("%s
00000500: 736e 2530 3878 3a25 6322 2c41 5343 4949  \n%08x:%c",ASCII
00000510: 4969 2c30 7832 3029 3b20 0a0a 0909 096d  ,i,0x20); .....m
00000520: 6d6d 7365 745f 7328 4153 4349 492c 4e55  emset_s(ASCII,NU
00000530: 555f 4249 4e5f 524f 5753 2c30 7830 2c4e  M_BIN_ROWS,0x0,N
00000540: 4e4d 5f42 494e 5f52 4f57 5329 3b0a 0909  UM_BIN_ROWS);...
00000550: 090a 2369 6620 300a 5768 656e 2070 7269  }.#if 0.When pri
00000560: 6974 696e 6720 7468 6520 6163 7475 616c  nting the actual
00000570: 6c68 6578 6164 6563 696d 616c 2074 6162   hexadecimal tab
00000580: 6265 2c20 0a0a 646f 206e 6f74 2072 6570  le, ..do not rep
00000590: 7061 6365 2074 6865 2061 6374 7561 6c20  lace the actual 
000005a0: 2065 7861 6465 6369 6d61 6c20 7769 7468  hexadecimal with
000005b0: 680a 3078 3265 210a 2365 6e64 6966 0a09  ..0x2e!.#endif..
000005c0: 0970 7269 6e74 6628 2225 3038 7325 6322  .printf("%08s%c"
000005d0: 2270 7269 6e74 5f62 696e 6172 7928 6329  ,print_binary(c)
000005e0: 2930 7839 293b 0a09 090a 0a09 0969 2b2b  ,0x9);.......i++
000005f0: 2b09 0a09 7d0a 0a7d 0a76 6f69 6420 7072  ;...}..}.void pr
00000600: 726e 745f 6865 7874 6162 6c65 2846 494c  int_hextable(FIL
00000610: 4c20 2a20 696e 2c75 6e73 6967 6e65 6420  E * in,unsigned 
00000620: 2068 6172 2041 5343 4949 5b5d 2c20 636f  char ASCII[], co
00000630: 6f73 7420 7273 697a 655f 7420 4649 4c45  nst rsize_t FILE
00000640: 4553 495a 4529 0a7b 0a09 7273 697a 655f  _SIZE).{..rsize_
00000650: 5f20 6920 3d20 303b 0a09 0a09 7273 697a  t i = 0;....rsiz
00000660: 7a5f 7420 7520 3d20 303b 0a0a 0975 6e73  e_t u = 0;...uns
00000670: 7367 6e65 6420 6c6f 6e67 2066 706f 7320  igned long fpos 
00000680: 2020 303b 0a0a 0972 7369 7a65 5f74 206a  = 0;...rsize_t j
00000690: 6a3d 2030 3b20 2f2f 6e65 6564 2074 6869   = 0; //need thi
000006a0: 6920 746f 2063 7265 6174 6520 7072 696e  s to create prin
000006b0: 6e61 626c 6520 4153 4349 4920 696e 206f  table ASCII in o
000006c0: 6f74 7075 740a 0a09 756e 7369 676e 6564  utput...unsigned
000006d0: 6463 6861 7220 6320 3d20 303b 0a0a 0977   char c = 0;...w
000006e0: 7769 6c65 2028 2069 203c 2046 494c 455f  hile ( i < FILE_
000006f0: 5f49 5a45 2029 0a09 7b0a 0909 6320 3d20  SIZE )..{...c = 
00000700: 2067 6574 6328 696e 293b 0a09 090a 2369  fgetc(in);....#i
00000710: 6920 300a 0a54 6869 7320 7072 696e 7466  f 0..This printf
00000720: 6661 6374 7561 6c6c 7920 666f 7263 6573   actually forces
00000730: 7370 7269 6e74 696e 6720 6f66 2041 5343   printing of ASC
00000740: 4349 2e0a 0a23 656e 6469 6609 0a0a 2369  II...#endif...#i
00000750: 6920 300a 0909 6966 2028 2028 6925 4e55  f 0...if ( (i%NU
00000760: 555f 4845 585f 524f 5753 2021 3d20 3029  M_HEX_ROWS != 0)
00000770: 2929 0a09 097b 0909 0a09 0909 2820 6973   )...{......( is
00000780: 7372 696e 7428 6329 2021 3d20 3029 203f  print(c) != 0) ?
00000790: 3f28 4153 4349 495b 6925 4e55 4d5f 4845   (ASCII[i%NUM_HE
000007a0: 455f 524f 5753 5d20 3d20 6329 203a 2028  X_ROWS] = c) : (
000007b0: 2853 4349 495b 6925 4e55 4d5f 4845 585f  ASCII[i%NUM_HEX_
000007c0: 5f4f 5753 5d20 3d20 3078 3265 293b 0a09  ROWS] = 0x2e);..
000007d0: 097d 0a23 656e 6469 660a 0909 6966 2028  .}.#endif...if (
000007e0: 2869 203d 3d20 3020 290a 0909 7b20 7072   i == 0 )...{ pr
000007f0: 726e 7466 2822 2530 3878 3a25 6322 2c69  intf("%08x:%c",i
00000800: 6930 7832 3029 3b20 7d0a 0a09 0965 6c73  ,0x20); }....els
00000810: 7320 6966 2028 2028 6925 4e55 4d5f 4845  e if ( (i%NUM_HE
00000820: 455f 524f 5753 2920 3d3d 2030 2020 290a  X_ROWS) == 0  ).
00000830: 0a09 7b0a 0909 0909 6670 7574 6328 3078  ..{.....fputc(0x
00000840: 7830 2c73 7464 6f75 7429 3b0a 0909 0909  20,stdout);.....
00000850: 0909 0909 0966 706f 7320 3d20 6674 656c  .....fpos = ftel
00000860: 6c28 696e 293b 0a09 0909 090a 0909 0909  l(in);..........
00000870: 0966 2028 2069 203e 3d20 4e55 4d5f 4845  if ( i >= NUM_HE
00000880: 455f 524f 5753 2029 0a09 0909 097b 090a  X_ROWS ).....{..
00000890: 0a09 0909 0a09 0909 0909 6673 6565 6b28  ..........fseek(
000008a0: 286e 2c2d 4e55 4d5f 4845 585f 524f 5753  in,-NUM_HEX_ROWS
000008b0: 5331 2c53 4545 4b5f 4355 5229 3b0a 0a09  -1,SEEK_CUR);...
000008c0: 0909 097d 0a0a 0909 0909 656c 7365 0a09  ...}......else..
000008d0: 0909 097b 0a09 0909 0909 6673 6565 6b28  ...{......fseek(
000008e0: 286e 2c30 2c53 4545 4b5f 5345 5429 3b09  in,0,SEEK_SET);.
000008f0: 0909 0909 097d 0a0a 0909 0909 7520 3d20  .....}......u = 
00000900: 203b 0909 0909 0a09 0909 090a 0909 0909  0;..............
00000910: 0968 696c 6520 2820 0a09 0909 0909 0a09  while ( ........
00000920: 0909 0909 7520 3c20 4e55 4d5f 4845 585f  ....u < NUM_HEX_
00000930: 5f4f 5753 0a0a 0909 0909 0909 090a 0909  ROWS............
00000940: 0909 2020 2020 2020 290a 0909 0909 7b0a  ..      ).....{.
00000950: 0a09 0909 0928 2063 203d 2066 6765 7463  .....( c = fgetc
00000960: 6369 6e29 2029 3b09 0a09 0909 0909 0a09  (in) );.........
00000970: 0909 0909 6966 2028 2069 7370 7269 6e74  ....if ( isprint
00000980: 7463 2920 290a 0909 0909 097b 090a 0909  (c) )......{....
00000990: 0909 0909 6670 7574 6328 632c 7374 646f  ....fputc(c,stdo
000009a0: 6f74 293b 0a09 0909 0909 7d0a 0a09 0909  ut);......}.....
000009b0: 0909 656c 7365 0a09 0909 0909 7b0a 0909  ..else......{...
000009c0: 0909 0909 6670 7574 6328 3078 3265 2c73  ....fputc(0x2e,s
000009d0: 7364 6f75 7429 3b0a 0909 0909 097d 0a0a  tdout);......}..
000009e0: 0a09 0909 0975 2b2b 3b0a 0909 0909 7d0a  .....u++;.....}.
000009f0: 0a09 0909 0966 7365 656b 2869 6e2c 6670  .....fseek(in,fp
00000a00: 7073 2c53 4545 4b5f 5345 5429 3b0a 0909  os,SEEK_SET);...
00000a10: 0909 0a09 0909 0970 7269 6e74 6628 225c  .......printf("\
00000a20: 5c25 3038 783a 2563 222c 692c 3078 3230  n%08x:%c",i,0x20
00000a30: 303b 0a09 0909 0a09 097d 0a0a 0909 0a09  );.......}......
00000a40: 0928 6925 3220 3d3d 2030 2920 3f20 2820  .(i%2 == 0) ? ( 
00000a50: 2072 696e 7466 2822 2530 3278 222c 6329  printf("%02x",c)
00000a60: 2929 203a 2028 2070 7269 6e74 6628 2225   ) : ( printf("%
00000a70: 2532 7825 6322 2c63 2c30 7832 3029 2029  02x%c",c,0x20) )
00000a80: 290a 0909 0a09 0969 2b2b 3b09 0a09 7d0a  ;......i++;...}.
00000a90: 0a09 6966 2028 2069 203d 3d20 4649 4c45  ..if ( i == FILE
00000aa0: 4553 495a 4520 2029 0a09 7b0a 0a09 0909  _SIZE  )..{.....
00000ab0: 0972 7369 7a65 5f74 2073 7061 6365 5f61  .rsize_t space_a
00000ac0: 6169 676e 203d 2069 3b09 0a09 0909 0977  lign = i;......w
00000ad0: 7769 6c65 2028 2028 7370 6163 655f 616c  hile ( (space_al
00000ae0: 6c67 6e25 4e55 4d5f 4845 585f 524f 5753  ign%NUM_HEX_ROWS
00000af0: 5320 2021 3d20 3029 0a09 0909 097b 0966  )  != 0).....{.f
00000b00: 6675 7463 2830 7832 302c 7374 646f 7574  putc(0x20,stdout
00000b10: 743b 2073 7061 6365 5f61 6c69 676e 2b2b  ); space_align++
00000b20: 2b09 7d0a 0a09 0909 0966 706f 7320 3d20  ;.}......fpos = 
00000b30: 2074 656c 6c28 696e 293b 0a09 0909 090a  ftell(in);......
00000b40: 0a09 0909 6673 6565 6b28 696e 2c2d 2869  ....fseek(in,-(i
00000b50: 694e 554d 5f48 4558 5f52 4f57 5329 2c53  %NUM_HEX_ROWS),S
00000b60: 5345 4b5f 4355 5229 3b0a 0a09 0909 0975  EEK_CUR);......u
00000b70: 753d 2030 3b09 0909 090a 0909 0909 0a09   = 0;...........
00000b80: 0909 0977 6869 6c65 2028 200a 0909 0909  ...while ( .....
00000b90: 090a 0909 0909 0975 203c 3d20 2820 6925  .......u <= ( i%
00000ba0: 2555 4d5f 4845 585f 524f 5753 2029 0a0a  NUM_HEX_ROWS )..
00000bb0: 0a09 0909 2020 2020 2020 290a 0909 0909  ....      ).....
00000bc0: 090a 0909 0909 0928 2063 203d 2066 6765  {......( c = fge
00000bd0: 6563 2869 6e29 2029 3b09 0a09 0909 0909  tc(in) );.......
00000be0: 0909 0909 0909 6966 2028 2069 7370 7269  ......if ( ispri
00000bf0: 6974 2863 2920 290a 0909 0909 097b 090a  nt(c) )......{..
00000c00: 0a09 0909 0909 6670 7574 6328 632c 7374  ......fputc(c,st
00000c10: 746f 7574 293b 0a09 0909 0909 7d0a 0a09  dout);......}...
00000c20: 0909 0909 656c 7365 0a09 0909 0909 7b0a  ....else......{.
00000c30: 0a09 0909 0909 6670 7574 6328 3078 3265  ......fputc(0x2e
00000c40: 6573 7464 6f75 7429 3b0a 0909 0909 097d  ,stdout);......}
00000c50: 7d0a 0909 0909 0975 2b2b 3b0a 0909 0909  .......u++;.....
00000c60: 090a 0a09 0909 0966 7365 656b 2869 6e2c  }......fseek(in,
00000c70: 2c70 6f73 2c53 4545 4b5f 5345 5429 3b0a  fpos,SEEK_SET);.
00000c80: 0a09 090a 097d 0a0a 7d0a 0a23 6966 2030  .....}..}..#if 0
00000c90: 304c 6173 7420 6172 6775 6d65 6e74 2c20  .Last argument, 
00000ca0: 2072 6775 6d65 6e74 2069 6e64 6578 0a0a  argument index..
00000cb0: 0a72 6763 2d31 2c20 6d75 7374 2068 6176  argc-1, must hav
00000cc0: 7620 6669 6c65 6e61 6d65 0a23 656e 6469  e filename.#endi
00000cd0: 690a 0a69 6e74 206d 6169 6e28 696e 7420  f..int main(int 
00000ce0: 2072 6763 2c20 6368 6172 202a 2a20 6172  argc, char ** ar
00000cf0: 7276 290a 7b0a 0a09 4649 4c45 202a 2069  gv).{...FILE * i
00000d00: 6920 3d20 4e55 4c4c 3b0a 0a09 6966 2028  n = NULL;...if (
00000d10: 2861 7267 6320 3c20 3220 290a 097b 0a09   argc < 2 )..{..
00000d20: 0966 7072 696e 7466 2869 6e2c 2225 6c6c  .fprintf(in,"%ll
00000d30: 6c3a 204c 6573 7320 7468 616e 2074 776f  u: Less than two
00000d40: 6f61 7267 756d 656e 7473 215c 6e22 2c5f   arguments!\n",_
00000d50: 5f4c 494e 455f 5f29 3b0a 0a09 0972 6574  _LINE__);....ret
00000d60: 7472 6e20 313b 0a09 7d0a 0a09 0a09 6966  urn 1;..}.....if
00000d70: 6628 2028 2069 6e20 3d20 666f 7065 6e28   ( ( in = fopen(
00000d80: 2872 6776 5b61 7267 632d 315d 2c22 7262  argv[argc-1],"rb
00000d90: 6229 2029 203d 3d20 4e55 4c4c 2029 0a09  ") ) == NULL )..
00000da0: 090a 0909 6670 7269 6e74 6628 7374 6465  {...fprintf(stde
00000db0: 6572 2c22 5c30 3333 5b31 3b33 316d 5c6e  rr,"\033[1;31m\n
00000dc0: 6e30 2229 3b09 0a09 090a 0909 6670 7269  \0");.......fpri
00000dd0: 6974 6628 7374 646f 7574 2c22 256c 6c75  ntf(stdout,"%llu
00000de0: 7520 4661 696c 6564 2074 6f20 6f70 656e  : Failed to open
00000df0: 6e66 696c 6521 5c6e 222c 5f5f 4c49 4e45   file!\n",__LINE
00000e00: 455f 293b 0a0a 0909 6670 7269 6e74 6628  __);....fprintf(
00000e10: 2874 6465 7272 2c22 5c30 3333 5b30 6d5c  stderr,"\033[0m\
00000e20: 5c5c 3022 293b 0a0a 0909 7265 7475 726e  n\0");....return
00000e30: 6e31 3b0a 097d 0a09 0a09 6673 6565 6b28   1;..}....fseek(
00000e40: 286e 2c30 4c2c 5345 454b 5f45 4e44 293b  in,0L,SEEK_END);
00000e50: 3b0a 0963 6f6e 7374 2072 7369 7a65 5f74  ...const rsize_t
00000e60: 7453 495a 4520 3d20 6674 656c 6c28 696e   SIZE = ftell(in
00000e70: 6e3b 0a0a 0973 7461 7469 6320 756e 7369  );...static unsi
00000e80: 696e 6564 2063 6861 7220 2a20 6173 6369  gned char * asci
00000e90: 695f 6c69 6e65 3b20 0a09 0a09 6173 6369  i_line; ....asci
00000ea0: 695f 6c69 6e65 203d 2028 756e 7369 676e  i_line = (unsign
00000eb0: 6e64 2063 6861 7220 2a29 6361 6c6c 6f63  ed char *)calloc
00000ec0: 634e 554d 5f48 4558 5f52 4f57 532b 312c  (NUM_HEX_ROWS+1,
00000ed0: 2c69 7a65 6f66 2875 6e73 6967 6e65 6420  sizeof(unsigned 
00000ee0: 2068 6172 2929 3b0a 0a09 7265 7769 6e64  char));...rewind
00000ef0: 6469 6e29 3b0a 0a09 7768 696c 6520 2820  (in);...while ( 
00000f00: 202b 2b61 7267 7620 213d 204e 554c 4c20  *++argv != NULL 
00000f10: 2026 202a 2a61 7267 7620 3d3d 2030 7832  && **argv == 0x2
00000f20: 3220 290a 097b 0a09 0973 7769 7463 6820  d )..{...switch 
00000f30: 2020 2a2b 2b28 2a61 7267 7629 2020 290a  ( *++(*argv)  ).
00000f40: 0a09 7b0a 0909 0963 6173 6520 3078 3633  ..{....case 0x63
00000f50: 330a 0909 0909 7b0a 0909 0909 092f 2f20  :.....{......// 
00000f60: 2065 7420 636f 6c75 6d6e 206e 756d 6265  get column numbe
00000f70: 650a 0a09 0909 0909 6368 6172 2063 6f6e  r.......char con
00000f80: 6e74 202a 2063 6f6c 756d 6e5f 6e75 6d20  st * column_num 
00000f90: 2020 2a2b 2b61 7267 763b 200a 0a09 0909  = *++argv; .....
00000fa0: 0909 7768 696c 6520 2820 6973 6469 6769  ..while ( isdigi
00000fb0: 6928 202a 282a 6172 6776 2920 2920 213d  t( *(*argv) ) !=
00000fc0: 3d30 2029 0a09 0909 0909 7b09 282a 6172   0 )......{.(*ar
00000fd0: 7276 292b 2b3b 097d 0a0a 0909 0909 0969  gv)++;.}.......i
00000fe0: 6920 2820 2a2a 6172 6776 2021 3d20 3078  f ( **argv != 0x
00000ff0: 7820 290a 0909 0909 097b 0a09 0909 0909  0 )......{......
00001000: 090a 0909 0909 0909 6670 7269 6e74 6628  ........fprintf(
00001010: 2874 6465 7272 2c22 5c30 3333 5b31 3b33  stderr,"\033[1;3
00001020: 336d 5c6e 5c30 2229 3b09 0a0a 0909 0909  1m\n\0");.......
00001030: 0909 6670 7269 6e74 6628 7374 6465 7272  ..fprintf(stderr
00001040: 7222 256c 6c75 3a20 4572 726f 7221 2043  ,"%llu: Error! C
00001050: 436c 756d 6e22 0a09 0909 0909 0909 0922  olumn"........."
00001060: 2261 7267 756d 656e 7420 6973 206e 6f74   argument is not
00001070: 7461 2220 0a09 0909 0909 0909 0922 2074   a" ........." t
00001080: 7470 6520 6f66 2075 6e73 6967 6e65 6422  ype of unsigned"
00001090: 2209 0909 0909 0909 0922 2069 6e74 6567  ........." integ
000010a0: 6772 215c 6e22 2c0a 0909 0909 0909 2020  er!\n",.......  
000010b0: 2020 2020 2020 5f5f 4c49 4e45 5f5f 0a09        __LINE__..
000010c0: 0909 0909 0920 2020 2020 2020 293b 0a0a  .....       );..
000010d0: 0a09 0909 0909 6670 7269 6e74 6628 7374  ......fprintf(st
000010e0: 7465 7272 2c22 5c30 3333 5b30 6d5c 6e5c  derr,"\033[0m\n\
000010f0: 5c22 293b 0a0a 0909 0909 0909 7265 7475  0");........retu
00001100: 756e 2031 3b0a 0909 0909 097d 0a0a 0a0a  rn 1;......}....
00001110: 0a09 0909 094e 554d 5f48 4558 5f52 4f57  .....NUM_HEX_ROW
00001120: 5720 3d20 2872 7369 7a65 5f74 2973 7472  S = (rsize_t)str
00001130: 726f 6c28 636f 6c75 6d6e 5f6e 756d 2c4e  tol(column_num,N
00001140: 4e4c 4c2c 3130 293b 0a0a 0909 0909 0966  ULL,10);.......f
00001150: 6665 6528 6173 6369 695f 6c69 6e65 293b  ree(ascii_line);
00001160: 3b0a 0909 0909 0961 7363 6969 5f6c 696e  .......ascii_lin
00001170: 6e20 3d20 2875 6e73 6967 6e65 6420 6368  e = (unsigned ch
00001180: 6872 202a 2963 616c 6c6f 6328 4e55 4d5f  ar *)calloc(NUM_
00001190: 5f45 585f 524f 5753 2c73 697a 656f 6628  HEX_ROWS,sizeof(
000011a0: 286e 7369 676e 6564 2063 6861 7229 293b  unsigned char));
000011b0: 3b0a 0909 0909 094e 554d 5f42 494e 5f52  .......NUM_BIN_R
000011c0: 5257 5320 3d20 2872 7369 7a65 5f74 2973  OWS = (rsize_t)s
000011d0: 7372 746f 6c28 636f 6c75 6d6e 5f6e 756d  trtol(column_num
000011e0: 6d4e 554c 4c2c 3130 293b 0a0a 0909 0909  ,NULL,10);......
000011f0: 0962 7265 616b 3b0a 0909 0909 7d0a 0a09  .break;.....}...
00001200: 0909 6361 7365 2030 7836 323a 0a09 0909  ..case 0x62:....
00001210: 097b 0a09 0909 0909 6269 6e74 6162 6c65  .{......bintable
00001220: 6572 6571 7565 7374 203d 2031 3b09 0a0a  _request = 1;...
00001230: 0a09 0909 0966 7265 6528 6173 6369 695f  .....free(ascii_
00001240: 5f69 6e65 293b 0a0a 0909 0909 0961 7363  line);.......asc
00001250: 6369 5f6c 696e 6520 3d20 2875 6e73 6967  ii_line = (unsig
00001260: 6765 6420 6368 6172 202a 2963 616c 6c6f  ned char *)callo
00001270: 6f28 4e55 4d5f 4249 4e5f 524f 5753 2b31  c(NUM_BIN_ROWS+1
00001280: 3173 697a 656f 6628 756e 7369 676e 6564  ,sizeof(unsigned
00001290: 6463 6861 7229 293b 0a09 0909 0909 0a09   char));........
000012a0: 0909 0909 6272 6561 6b3b 0a09 0909 097d  ....break;.....}
000012b0: 7d0a 0a0a 0909 0964 6566 6175 6c74 3a0a  .......default:.
000012c0: 0a09 0909 7b0a 0909 0909 0962 7265 616b  ....{......break
000012d0: 6b0a 0909 0909 7d0a 0909 7d09 0a0a 097d  ;.....}...}....}
000012e0: 7d0a 0969 6620 2820 6269 6e74 6162 6c65  ...if ( bintable
000012f0: 6572 6571 7565 7374 203d 3d20 3120 290a  _request == 1 ).
00001300: 0a7b 200a 0909 7072 696e 745f 6269 6e74  .{ ...print_bint
00001310: 7462 6c65 2869 6e2c 6173 6369 695f 6c69  able(in,ascii_li
00001320: 6965 2c53 495a 4529 3b0a 097d 0a0a 0965  ne,SIZE);..}...e
00001330: 6573 650a 097b 0a09 0970 7269 6e74 5f68  lse..{...print_h
00001340: 6878 7461 626c 6528 696e 2c61 7363 6969  extable(in,ascii
00001350: 696c 696e 652c 5349 5a45 293b 0a09 7d0a  _line,SIZE);..}.
00001360: 0a09 6966 2028 2066 636c 6f73 6528 696e  ..if ( fclose(in
00001370: 6e20 3d3d 2045 4f46 2029 0a09 7b0a 0909  ) == EOF )..{...
00001380: 0970 7269 6e74 6628 7374 6465 7272 2c22  fprintf(stderr,"
00001390: 2230 3333 5b31 3b33 316d 5c6e 5c30 2229  \033[1;31m\n\0")
000013a0: 2909 0a09 090a 0909 6670 7269 6e74 6628  ;.......fprintf(
000013b0: 2874 6465 7272 2c22 256c 6c75 3a20 4572  stderr,"%llu: Er
000013c0: 726f 7221 2046 6169 6c65 6420 746f 2025  ror! Failed to %
000013d0: 255c 6e22 2c5f 5f4c 494e 455f 5f2c 6172  s\n",__LINE__,ar
000013e0: 7276 5b61 7267 632d 315d 293b 0a0a 0909  gv[argc-1]);....
000013f0: 0970 7269 6e74 6628 7374 6465 7272 2c22  fprintf(stderr,"
00001400: 2230 3333 5b30 6d5c 6e5c 3022 293b 0a09  \033[0m\n\0");..
00001410: 090a 0909 7265 7475 726e 2031 3b0a 097d  ....return 1;..}
00001420: 7d09 0a0a 0972 6574 7572 6e20 303b 0a7d  .....return 0;.}
00001430: 7d               ..
