00000000:  23 69 66 20 30 0a 43 6f 70 79 72 69 67 68 74 20 #if 0·Copyright 
00000010:  28 43 29 20 54 61 6e 76 65 65 72 20 53 61 6c 69 (C) Tanveer Sali
00000020:  6d 20 32 30 31 38 2d 49 4e 46 49 4e 49 54 59 0a m 2018-INFINITY·
00000030:  0a 54 68 69 73 20 73 6f 66 74 77 61 72 65 20 69 ·This software i
00000040:  73 20 64 69 73 74 72 69 62 75 74 65 64 20 77 69 s distributed wi
00000050:  74 68 20 61 20 47 4e 55 20 47 50 4c 0a 0a 4c 69 th a GNU GPL··Li
00000060:  63 65 6e 73 65 20 76 32 2e 30 2e 20 41 6c 6c 20 cense v2.0. All 
00000070:  61 72 65 20 66 72 65 65 20 74 6f 20 63 6f 70 79 are free to copy
00000080:  2c 20 73 68 61 72 65 2c 20 0a 09 0a 09 0a 64 69 , share, ·····di
00000090:  73 74 72 69 62 75 74 65 2c 20 61 6e 64 2f 6f 72 stribute, and/or
000000a0:  20 6d 6f 64 69 66 79 20 74 68 69 73 20 73 6f 66  modify this sof
000000b0:  74 77 61 72 65 2e 0a 0a 41 6c 6c 20 73 6f 66 74 tware.··All soft
000000c0:  77 61 72 65 20 74 68 61 74 20 77 61 73 20 69 6e ware that was in
000000d0:  73 70 69 72 65 64 0a 0a 6f 72 20 69 73 20 61 20 spired··or is a 
000000e0:  64 65 72 69 76 61 74 69 76 65 20 6f 66 20 74 68 derivative of th
000000f0:  69 73 20 77 6f 72 6b 20 6d 75 73 74 20 68 61 76 is work must hav
00000100:  65 0a 0a 74 68 65 20 65 78 61 63 74 20 73 61 6d e··the exact sam
00000110:  65 20 4c 49 43 45 4e 53 45 20 61 6e 64 20 63 6f e LICENSE and co
00000120:  70 79 72 69 67 68 74 20 70 65 72 6d 69 73 73 69 pyright permissi
00000130:  6f 6e 73 2e 0a 0a 23 65 6e 64 69 66 0a 0a 23 69 ons.··#endif··#i
00000140:  6e 63 6c 75 64 65 20 3c 73 74 64 69 6f 2e 68 3e nclude <stdio.h>
00000150:  0a 23 69 6e 63 6c 75 64 65 20 3c 73 74 64 69 6e ·#include <stdin
00000160:  74 2e 68 3e 0a 23 69 6e 63 6c 75 64 65 20 3c 73 t.h>·#include <s
00000170:  74 64 6c 69 62 2e 68 3e 0a 23 69 6e 63 6c 75 64 tdlib.h>·#includ
00000180:  65 20 3c 63 74 79 70 65 2e 68 3e 0a 23 69 6e 63 e <ctype.h>·#inc
00000190:  6c 75 64 65 20 3c 73 74 72 69 6e 67 2e 68 3e 0a lude <string.h>·
000001a0:  0a 23 69 66 6e 64 65 66 20 5f 5f 72 73 69 7a 65 ·#ifndef __rsize
000001b0:  5f 74 5f 64 65 66 69 6e 65 64 0a 74 79 70 65 64 _t_defined·typed
000001c0:  65 66 20 73 69 7a 65 5f 74 20 72 73 69 7a 65 5f ef size_t rsize_
000001d0:  74 3b 0a 23 64 65 66 69 6e 65 20 5f 5f 72 73 69 t;·#define __rsi
000001e0:  7a 65 5f 74 5f 64 65 66 69 6e 65 64 20 31 0a 23 ze_t_defined 1·#
000001f0:  65 6e 64 69 66 0a 0a 0a 23 69 66 20 30 0a 0a 42 endif···#if 0··B
00000200:  75 67 3a 20 57 68 65 6e 20 4e 75 6d 62 65 72 20 ug: When Number 
00000210:  6f 66 20 63 68 61 72 61 63 74 65 72 73 20 69 6e of characters in
00000220:  20 72 6f 77 0a 0a 69 73 20 65 71 75 61 6c 20 74  row··is equal t
00000230:  6f 20 4e 55 4d 5f 48 45 58 5f 52 4f 57 53 2c 20 o NUM_HEX_ROWS, 
00000240:  74 68 65 20 6c 61 73 74 20 66 0a 0a 69 6e 20 30 the last f··in 0
00000250:  78 66 66 20 69 73 20 64 65 6c 65 74 65 64 20 61 xff is deleted a
00000260:  6e 64 20 72 65 70 6c 61 63 65 64 20 77 69 74 68 nd replaced with
00000270:  0a 0a 61 20 70 65 72 69 6f 64 2e 0a 0a 42 75 67 ··a period.··Bug
00000280:  3a 20 4e 75 6d 62 65 72 20 6f 66 20 63 6f 6c 75 : Number of colu
00000290:  6d 6e 73 20 3d 3d 20 4e 75 6d 62 65 72 20 6f 66 mns == Number of
000002a0:  20 62 79 74 65 73 20 70 65 72 20 72 6f 77 21 0a  bytes per row!·
000002b0:  0a 4e 55 4d 5f 48 45 58 5f 52 4f 57 53 20 3d 3d ·NUM_HEX_ROWS ==
000002c0:  20 28 64 65 73 69 72 65 64 20 6e 75 6d 62 65 72  (desired number
000002d0:  20 6f 66 20 63 6f 6c 75 6d 6e 73 29 2f 32 0a 0a  of columns)/2··
000002e0:  64 65 66 61 75 6c 74 20 6e 75 6d 62 65 72 20 6f default number o
000002f0:  66 20 63 6f 6c 75 6d 6e 73 3a 20 31 36 20 74 6f f columns: 16 to
00000300:  20 6d 61 6b 65 20 31 36 20 62 79 74 65 73 20 64  make 16 bytes d
00000310:  69 73 70 6c 61 79 65 64 20 69 6e 20 74 6f 74 61 isplayed in tota
00000320:  6c 20 70 65 72 20 72 6f 77 0a 0a 53 6f 3a 0a 0a l per row··So:··
00000330:  4e 55 4d 5f 48 45 58 5f 52 4f 57 53 20 3d 3d 20 NUM_HEX_ROWS == 
00000340:  4e 75 6d 62 65 72 20 6f 66 20 64 65 73 69 72 65 Number of desire
00000350:  64 20 63 6f 6c 75 6d 6e 73 0a 0a 53 69 6d 70 6c d columns··Simpl
00000360:  65 21 20 3a 44 0a 23 65 6e 64 69 66 0a 2f 2f 23 e! :D·#endif·//#
00000370:  64 65 66 69 6e 65 20 4e 55 4d 5f 48 45 58 5f 52 define NUM_HEX_R
00000380:  4f 57 53 5f 4f 52 49 47 49 4e 41 4c 20 31 36 0a OWS_ORIGINAL 16·
00000390:  0a 72 73 69 7a 65 5f 74 20 4e 55 4d 5f 48 45 58 ·rsize_t NUM_HEX
000003a0:  5f 52 4f 57 53 20 3d 20 31 36 3b 0a 0a 72 73 69 _ROWS = 16;··rsi
000003b0:  7a 65 5f 74 20 4e 55 4d 5f 42 49 4e 5f 52 4f 57 ze_t NUM_BIN_ROW
000003c0:  53 20 3d 20 36 3b 0a 0a 72 73 69 7a 65 5f 74 20 S = 6;··rsize_t 
000003d0:  4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 20 3d 20 31 NUM_OCT_ROWS = 1
000003e0:  32 3b 0a 0a 72 73 69 7a 65 5f 74 20 4e 55 4d 5f 2;··rsize_t NUM_
000003f0:  44 45 43 5f 52 4f 57 53 20 3d 20 31 32 3b 0a 0a DEC_ROWS = 12;··
00000400:  5f 42 6f 6f 6c 20 62 69 6e 74 61 62 6c 65 5f 72 _Bool bintable_r
00000410:  65 71 75 65 73 74 20 3d 20 30 3b 0a 0a 5f 42 6f equest = 0;··_Bo
00000420:  6f 6c 20 6f 63 74 74 61 62 6c 65 5f 72 65 71 75 ol octtable_requ
00000430:  65 73 74 20 3d 20 30 3b 0a 0a 5f 42 6f 6f 6c 20 est = 0;··_Bool 
00000440:  64 65 63 74 61 62 6c 65 5f 72 65 71 75 65 73 74 dectable_request
00000450:  20 3d 20 30 3b 0a 0a 0a 76 6f 69 64 20 63 6f 6c  = 0;···void col
00000460:  6f 72 63 68 61 72 28 75 69 6e 74 38 5f 74 20 63 orchar(uint8_t c
00000470:  29 0a 7b 0a 09 0a 09 09 69 66 20 28 20 63 20 3d )·{·····if ( c =
00000480:  3d 20 30 78 30 20 29 0a 09 09 7b 0a 09 09 09 70 = 0x0 )···{····p
00000490:  72 69 6e 74 66 28 22 5c 65 5b 33 38 3b 35 3b 32 rintf("\e[38;5;2
000004a0:  34 34 6d 22 29 3b 0a 09 09 7d 0a 0a 09 09 65 6c 44m");···}····el
000004b0:  73 65 20 69 66 20 28 20 69 73 61 6c 70 68 61 28 se if ( isalpha(
000004c0:  63 29 20 29 0a 09 09 7b 0a 09 09 09 0a 09 09 09 c) )···{········
000004d0:  70 72 69 6e 74 66 28 22 5c 65 5b 33 38 3b 35 3b printf("\e[38;5;
000004e0:  32 30 38 6d 22 29 3b 0a 0a 0a 09 09 7d 0a 0a 09 208m");·····}···
000004f0:  09 65 6c 73 65 20 69 66 20 28 20 69 73 64 69 67 ·else if ( isdig
00000500:  69 74 28 63 29 20 29 0a 09 09 7b 0a 09 09 09 70 it(c) )···{····p
00000510:  72 69 6e 74 66 28 22 5c 65 5b 33 38 3b 35 3b 32 rintf("\e[38;5;2
00000520:  32 36 6d 22 29 3b 0a 09 09 7d 09 0a 09 0a 09 09 26m");···}······
00000530:  65 6c 73 65 20 69 66 20 28 20 21 69 73 70 72 69 else if ( !ispri
00000540:  6e 74 28 63 29 20 29 0a 09 09 7b 0a 09 09 09 70 nt(c) )···{····p
00000550:  72 69 6e 74 66 28 22 5c 65 5b 33 38 3b 35 3b 31 rintf("\e[38;5;1
00000560:  39 36 6d 22 29 3b 0a 09 09 7d 0a 0a 09 09 65 6c 96m");···}····el
00000570:  73 65 20 69 66 20 28 20 69 73 73 70 61 63 65 28 se if ( isspace(
00000580:  63 29 20 29 0a 09 09 7b 0a 09 09 09 70 72 69 6e c) )···{····prin
00000590:  74 66 28 22 5c 65 5b 33 38 3b 35 3b 34 30 6d 22 tf("\e[38;5;40m"
000005a0:  29 3b 0a 09 09 7d 0a 0a 09 09 65 6c 73 65 20 69 );···}····else i
000005b0:  66 20 28 20 69 73 70 75 6e 63 74 28 63 29 20 29 f ( ispunct(c) )
000005c0:  0a 09 09 7b 0a 2f 2f 09 09 09 70 72 69 6e 74 66 ···{·//···printf
000005d0:  28 22 5c 65 5b 33 38 3b 35 3b 31 36 34 6d 22 29 ("\e[38;5;164m")
000005e0:  3b 0a 09 09 09 0a 09 09 09 70 72 69 6e 74 66 28 ;········printf(
000005f0:  22 5c 65 5b 33 38 3b 35 3b 32 30 31 6d 22 29 3b "\e[38;5;201m");
00000600:  0a 09 09 7d 0a 0a 09 09 65 6c 73 65 20 69 66 20 ···}····else if 
00000610:  28 20 63 20 3c 20 31 36 20 29 0a 09 09 7b 0a 09 ( c < 16 )···{··
00000620:  09 09 70 72 69 6e 74 66 28 22 5c 65 5b 30 3b 33 ··printf("\e[0;3
00000630:  32 6d 22 29 3b 0a 09 09 7d 0a 0a 09 09 65 6c 73 2m");···}····els
00000640:  65 20 69 66 20 28 20 63 20 3e 3d 20 31 36 20 26 e if ( c >= 16 &
00000650:  26 20 63 20 3c 3d 20 33 31 20 29 0a 09 09 7b 0a & c <= 31 )···{·
00000660:  09 09 09 70 72 69 6e 74 66 28 22 5c 65 5b 31 3b ···printf("\e[1;
00000670:  33 35 6d 22 29 3b 0a 09 09 7d 0a 0a 7d 0a 0a 76 35m");···}··}··v
00000680:  6f 69 64 20 72 65 73 65 74 63 6f 6c 6f 72 28 76 oid resetcolor(v
00000690:  6f 69 64 29 0a 7b 0a 09 70 72 69 6e 74 66 28 22 oid)·{··printf("
000006a0:  5c 30 33 33 5b 30 6d 22 29 3b 0a 7d 0a 0a 76 6f \033[0m");·}··vo
000006b0:  69 64 20 70 72 69 6e 74 76 69 65 77 28 46 49 4c id printview(FIL
000006c0:  45 20 2a 20 69 6e 2c 20 46 49 4c 45 20 2a 20 6f E * in, FILE * o
000006d0:  75 74 2c 63 6f 6e 73 74 20 72 73 69 7a 65 5f 74 ut,const rsize_t
000006e0:  20 46 49 4c 45 5f 53 49 5a 45 29 0a 7b 0a 09 72  FILE_SIZE)·{··r
000006f0:  73 69 7a 65 5f 74 20 69 20 3d 20 30 3b 0a 0a 09 size_t i = 0;···
00000700:  75 69 6e 74 38 5f 74 20 63 20 3d 20 30 3b 0a 09 uint8_t c = 0;··
00000710:  0a 09 77 68 69 6c 65 20 28 20 69 20 3c 20 46 49 ··while ( i < FI
00000720:  4c 45 5f 53 49 5a 45 20 29 0a 09 7b 0a 09 09 63 LE_SIZE )··{···c
00000730:  20 3d 20 66 67 65 74 63 28 69 6e 29 3b 0a 0a 09  = fgetc(in);···
00000740:  09 69 66 20 28 20 6f 75 74 20 21 3d 20 73 74 64 ·if ( out != std
00000750:  6f 75 74 20 29 0a 09 09 7b 09 0a 09 09 09 66 70 out )···{·····fp
00000760:  72 69 6e 74 66 28 6f 75 74 2c 22 25 63 22 2c 63 rintf(out,"%c",c
00000770:  29 3b 0a 09 09 7d 0a 09 09 09 0a 09 09 65 6c 73 );···}·······els
00000780:  65 0a 09 09 7b 0a 09 09 09 63 6f 6c 6f 72 63 68 e···{····colorch
00000790:  61 72 28 63 29 3b 0a 09 09 09 70 72 69 6e 74 66 ar(c);····printf
000007a0:  28 22 25 63 22 2c 63 29 3b 0a 09 09 09 72 65 73 ("%c",c);····res
000007b0:  65 74 63 6f 6c 6f 72 28 29 3b 0a 09 09 7d 0a 09 etcolor();···}··
000007c0:  09 0a 0a 09 09 69 2b 2b 3b 0a 09 7d 0a 0a 7d 0a ·····i++;··}··}·
000007d0:  76 6f 69 64 20 72 65 76 65 72 73 65 28 75 6e 73 void reverse(uns
000007e0:  69 67 6e 65 64 20 63 68 61 72 20 73 5b 5d 29 0a igned char s[])·
000007f0:  7b 0a 20 20 66 6f 72 20 28 69 6e 74 20 69 20 3d {·  for (int i =
00000800:  20 30 2c 20 6a 20 3d 20 73 74 72 6c 65 6e 28 73  0, j = strlen(s
00000810:  29 2d 31 3b 20 69 20 3c 20 6a 3b 20 69 2b 2b 2c )-1; i < j; i++,
00000820:  20 6a 2d 2d 29 0a 20 20 7b 0a 20 20 20 20 75 6e  j--)·  {·    un
00000830:  73 69 67 6e 65 64 20 63 68 61 72 20 74 65 6d 70 signed char temp
00000840:  20 3d 20 73 5b 69 5d 3b 0a 0a 20 20 20 20 73 5b  = s[i];··    s[
00000850:  69 5d 20 3d 20 73 5b 6a 5d 3b 0a 0a 20 20 20 20 i] = s[j];··    
00000860:  73 5b 6a 5d 20 3d 20 74 65 6d 70 3b 0a 20 20 7d s[j] = temp;·  }
00000870:  0a 7d 0a 0a 75 6e 73 69 67 6e 65 64 20 63 68 61 ·}··unsigned cha
00000880:  72 20 2a 20 70 72 69 6e 74 5f 62 69 6e 61 72 79 r * print_binary
00000890:  28 75 6e 73 69 67 6e 65 64 20 63 68 61 72 20 69 (unsigned char i
000008a0:  6e 70 75 74 29 0a 7b 0a 0a 0a 20 20 73 74 61 74 nput)·{···  stat
000008b0:  69 63 20 75 6e 73 69 67 6e 65 64 20 63 68 61 72 ic unsigned char
000008c0:  20 73 5b 31 30 5d 3b 0a 0a 20 20 75 6e 73 69 67  s[10];··  unsig
000008d0:  6e 65 64 20 63 68 61 72 20 2a 20 73 5f 70 20 3d ned char * s_p =
000008e0:  20 26 73 5b 30 5d 3b 0a 0a 20 20 77 68 69 6c 65  &s[0];··  while
000008f0:  20 28 69 6e 70 75 74 20 3e 20 30 29 0a 20 20 7b  (input > 0)·  {
00000900:  0a 20 20 20 20 2a 73 5f 70 2b 2b 20 3d 20 28 75 ·    *s_p++ = (u
00000910:  6e 73 69 67 6e 65 64 20 63 68 61 72 29 28 28 69 nsigned char)((i
00000920:  6e 70 75 74 26 31 29 2b 27 30 27 29 3b 0a 0a 20 nput&1)+'0');·· 
00000930:  20 20 20 69 6e 70 75 74 20 3e 3e 3d 20 31 3b 0a    input >>= 1;·
00000940:  20 20 7d 0a 0a 20 20 2a 73 5f 70 20 3d 20 27 5c   }··  *s_p = '\
00000950:  30 27 3b 0a 20 20 0a 20 20 72 65 76 65 72 73 65 0';·  ·  reverse
00000960:  28 73 29 3b 0a 0a 20 20 72 65 74 75 72 6e 20 73 (s);··  return s
00000970:  3b 0a 0a 7d 0a 0a 0a 0a 76 6f 69 64 20 70 72 69 ;··}····void pri
00000980:  6e 74 5f 62 69 6e 74 61 62 6c 65 32 28 46 49 4c nt_bintable2(FIL
00000990:  45 20 2a 20 69 6e 2c 20 46 49 4c 45 20 2a 20 6f E * in, FILE * o
000009a0:  75 74 2c 20 75 6e 73 69 67 6e 65 64 20 63 68 61 ut, unsigned cha
000009b0:  72 20 41 53 43 49 49 5b 5d 2c 20 63 6f 6e 73 74 r ASCII[], const
000009c0:  20 72 73 69 7a 65 5f 74 20 46 49 4c 45 5f 53 49  rsize_t FILE_SI
000009d0:  5a 45 29 0a 7b 0a 09 72 73 69 7a 65 5f 74 20 69 ZE)·{··rsize_t i
000009e0:  20 3d 20 30 3b 0a 09 0a 09 72 73 69 7a 65 5f 74  = 0;····rsize_t
000009f0:  20 75 20 3d 20 30 3b 0a 0a 09 75 6e 73 69 67 6e  u = 0;···unsign
00000a00:  65 64 20 6c 6f 6e 67 20 66 70 6f 73 20 3d 20 30 ed long fpos = 0
00000a10:  3b 0a 0a 09 72 73 69 7a 65 5f 74 20 6a 20 3d 20 ;···rsize_t j = 
00000a20:  30 3b 20 2f 2f 6e 65 65 64 20 74 68 69 73 20 74 0; //need this t
00000a30:  6f 20 63 72 65 61 74 65 20 70 72 69 6e 74 61 62 o create printab
00000a40:  6c 65 20 41 53 43 49 49 20 69 6e 20 6f 75 74 70 le ASCII in outp
00000a50:  75 74 0a 0a 09 75 6e 73 69 67 6e 65 64 20 63 68 ut···unsigned ch
00000a60:  61 72 20 63 20 3d 20 30 3b 0a 0a 09 77 68 69 6c ar c = 0;···whil
00000a70:  65 20 28 20 69 20 3c 20 46 49 4c 45 5f 53 49 5a e ( i < FILE_SIZ
00000a80:  45 20 29 0a 09 7b 0a 09 09 63 20 3d 20 66 67 65 E )··{···c = fge
00000a90:  74 63 28 69 6e 29 3b 0a 09 09 0a 23 69 66 20 30 tc(in);····#if 0
00000aa0:  0a 0a 54 68 69 73 20 70 72 69 6e 74 66 20 61 63 ··This printf ac
00000ab0:  74 75 61 6c 6c 79 20 66 6f 72 63 65 73 20 70 72 tually forces pr
00000ac0:  69 6e 74 69 6e 67 20 6f 66 20 41 53 43 49 49 2e inting of ASCII.
00000ad0:  0a 0a 23 65 6e 64 69 66 09 0a 09 09 69 66 20 28 ··#endif····if (
00000ae0:  20 69 20 3d 3d 20 30 20 29 0a 09 09 7b 20 63 6f  i == 0 )···{ co
00000af0:  6c 6f 72 63 68 61 72 28 63 29 3b 20 66 70 72 69 lorchar(c); fpri
00000b00:  6e 74 66 28 6f 75 74 2c 22 25 30 38 78 3a 25 63 ntf(out,"%08x:%c
00000b10:  22 2c 69 2c 30 78 32 30 29 3b 20 72 65 73 65 74 ",i,0x20); reset
00000b20:  63 6f 6c 6f 72 28 29 3b 20 7d 0a 09 09 0a 09 09 color(); }······
00000b30:  65 6c 73 65 20 69 66 20 28 20 28 69 25 4e 55 4d else if ( (i%NUM
00000b40:  5f 42 49 4e 5f 52 4f 57 53 29 20 3d 3d 20 30 20 _BIN_ROWS) == 0 
00000b50:  20 29 0a 09 09 7b 0a 09 09 09 09 66 70 75 74 63  )···{·····fputc
00000b60:  28 30 78 32 30 2c 6f 75 74 29 3b 0a 09 09 09 09 (0x20,out);·····
00000b70:  0a 09 09 09 09 69 66 20 28 20 69 20 3e 3d 20 4e ·····if ( i >= N
00000b80:  55 4d 5f 42 49 4e 5f 52 4f 57 53 20 29 0a 09 09 UM_BIN_ROWS )···
00000b90:  09 09 7b 09 0a 09 09 09 09 0a 09 09 09 09 09 66 ··{············f
00000ba0:  73 65 65 6b 28 69 6e 2c 2d 4e 55 4d 5f 42 49 4e seek(in,-NUM_BIN
00000bb0:  5f 52 4f 57 53 2d 31 2c 53 45 45 4b 5f 43 55 52 _ROWS-1,SEEK_CUR
00000bc0:  29 3b 0a 0a 09 09 09 09 7d 0a 0a 09 09 09 09 65 );······}······e
00000bd0:  6c 73 65 0a 09 09 09 09 7b 0a 09 09 09 09 09 66 lse·····{······f
00000be0:  73 65 65 6b 28 69 6e 2c 30 2c 53 45 45 4b 5f 53 seek(in,0,SEEK_S
00000bf0:  45 54 29 3b 09 0a 09 09 09 09 7d 0a 0a 09 09 09 ET);······}·····
00000c00:  09 75 20 3d 20 30 3b 09 09 09 09 0a 09 09 09 09 ·u = 0;·········
00000c10:  0a 09 09 09 09 77 68 69 6c 65 20 28 20 0a 09 09 ·····while ( ···
00000c20:  09 09 09 0a 09 09 09 09 09 75 20 3c 20 4e 55 4d ·········u < NUM
00000c30:  5f 42 49 4e 5f 52 4f 57 53 0a 0a 09 09 09 09 09 _BIN_ROWS·······
00000c40:  09 09 0a 09 09 09 09 20 20 20 20 20 20 29 0a 09 ·······      )··
00000c50:  09 09 09 7b 0a 09 09 09 09 09 28 20 63 20 3d 20 ···{······( c = 
00000c60:  66 67 65 74 63 28 69 6e 29 20 29 3b 09 0a 09 09 fgetc(in) );····
00000c70:  09 09 09 0a 09 09 09 09 09 63 6f 6c 6f 72 63 68 ·········colorch
00000c80:  61 72 28 63 29 3b 0a 0a 09 09 09 09 09 69 66 20 ar(c);·······if 
00000c90:  28 20 69 73 70 72 69 6e 74 28 63 29 20 29 0a 09 ( isprint(c) )··
00000ca0:  09 09 09 09 7b 09 0a 09 09 09 09 09 09 66 70 75 ····{········fpu
00000cb0:  74 63 28 63 2c 6f 75 74 29 3b 0a 09 09 09 09 09 tc(c,out);······
00000cc0:  7d 0a 0a 09 09 09 09 09 65 6c 73 65 0a 09 09 09 }·······else····
00000cd0:  09 09 7b 0a 09 09 09 09 09 09 66 70 72 69 6e 74 ··{·······fprint
00000ce0:  66 28 6f 75 74 2c 22 5c 75 30 30 62 37 22 29 3b f(out,"\u00b7");
00000cf0:  0a 09 09 09 09 09 7d 0a 0a 09 09 09 09 09 75 2b ······}·······u+
00000d00:  2b 3b 0a 0a 09 09 09 09 09 72 65 73 65 74 63 6f +;·······resetco
00000d10:  6c 6f 72 28 29 3b 0a 09 09 09 09 7d 0a 0a 09 09 lor();·····}····
00000d20:  09 09 63 20 3d 20 66 67 65 74 63 28 69 6e 29 3b ··c = fgetc(in);
00000d30:  20 2f 2f 63 61 74 63 68 20 75 70 20 74 6f 20 6c  //catch up to l
00000d40:  61 74 65 73 74 20 72 6f 77 0a 0a 0a 09 09 09 09 atest row·······
00000d50:  63 6f 6c 6f 72 63 68 61 72 28 63 29 3b 0a 0a 09 colorchar(c);···
00000d60:  09 09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ···fprintf(out,"
00000d70:  5c 6e 25 30 38 78 3a 25 63 22 2c 69 2c 30 78 32 \n%08x:%c",i,0x2
00000d80:  30 29 3b 0a 0a 09 09 09 09 72 65 73 65 74 63 6f 0);······resetco
00000d90:  6c 6f 72 28 29 3b 09 0a 09 09 7d 0a 09 09 0a 09 lor();····}·····
00000da0:  09 63 6f 6c 6f 72 63 68 61 72 28 63 29 3b 0a 0a ·colorchar(c);··
00000db0:  09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 25 ··fprintf(out,"%
00000dc0:  30 38 73 25 63 22 2c 70 72 69 6e 74 5f 62 69 6e 08s%c",print_bin
00000dd0:  61 72 79 28 63 29 2c 30 78 32 30 29 3b 0a 0a 09 ary(c),0x20);···
00000de0:  09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b 0a 0a ·resetcolor();··
00000df0:  23 69 66 20 30 09 0a 09 09 28 69 25 32 20 3d 3d #if 0····(i%2 ==
00000e00:  20 30 29 20 3f 20 28 20 66 70 72 69 6e 74 66 28  0) ? ( fprintf(
00000e10:  6f 75 74 2c 22 25 30 38 73 22 2c 70 72 69 6e 74 out,"%08s",print
00000e20:  5f 62 69 6e 61 72 79 28 63 29 29 20 29 20 3a 20 _binary(c)) ) : 
00000e30:  28 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 25 ( fprintf(out,"%
00000e40:  30 38 73 25 63 22 2c 70 72 69 6e 74 5f 62 69 6e 08s%c",print_bin
00000e50:  61 72 79 28 63 29 2c 30 78 32 30 29 20 29 3b 0a ary(c),0x20) );·
00000e60:  0a 23 65 6e 64 69 66 09 09 0a 09 09 69 2b 2b 3b ·#endif·····i++;
00000e70:  09 0a 09 09 0a 0a 09 09 2f 2f 20 42 75 67 3a 20 ········// Bug: 
00000e80:  57 72 69 74 65 20 63 6f 64 65 20 74 6f 20 70 6c Write code to pl
00000e90:  61 63 65 20 66 66 20 61 6e 64 20 65 78 74 72 61 ace ff and extra
00000ea0:  20 73 70 61 63 65 73 20 74 6f 20 61 6c 69 67 6e  spaces to align
00000eb0:  20 6c 61 73 74 20 41 53 43 49 49 20 6c 69 6e 65  last ASCII line
00000ec0:  20 68 65 72 65 0a 09 7d 0a 0a 09 09 69 66 20 28  here··}····if (
00000ed0:  20 69 20 3d 3d 20 46 49 4c 45 5f 53 49 5a 45 20  i == FILE_SIZE 
00000ee0:  29 0a 09 09 7b 0a 09 09 09 72 73 69 7a 65 5f 74 )···{····rsize_t
00000ef0:  20 69 6e 64 65 78 20 3d 20 69 3b 0a 0a 09 09 09  index = i;·····
00000f00:  77 68 69 6c 65 20 28 20 69 6e 64 65 78 20 25 20 while ( index % 
00000f10:  4e 55 4d 5f 42 49 4e 5f 52 4f 57 53 20 21 3d 20 NUM_BIN_ROWS != 
00000f20:  30 20 29 20 0a 09 09 09 7b 0a 09 09 09 09 0a 09 0 ) ····{·······
00000f30:  09 09 09 0a 09 09 09 09 28 69 6e 64 65 78 25 32 ········(index%2
00000f40:  20 3d 3d 20 30 29 20 0a 09 09 09 09 09 0a 09 09  == 0) ·········
00000f50:  09 09 09 3f 20 0a 09 09 09 09 09 0a 09 09 09 09 ···? ···········
00000f60:  09 28 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ·( fprintf(out,"
00000f70:  25 2a 63 22 2c 30 78 39 2c 30 78 32 30 29 20 29 %*c",0x9,0x20) )
00000f80:  20 0a 09 09 09 09 09 0a 09 09 09 09 09 3a 20 0a  ············: ·
00000f90:  09 09 09 09 09 0a 09 09 09 09 09 28 20 66 70 72 ···········( fpr
00000fa0:  69 6e 74 66 28 6f 75 74 2c 22 25 2a 63 22 2c 30 intf(out,"%*c",0
00000fb0:  78 39 2c 30 78 32 30 29 20 29 3b 0a 09 09 09 09 x9,0x20) );·····
00000fc0:  0a 09 09 09 09 69 6e 64 65 78 2b 2b 3b 0a 09 09 ·····index++;···
00000fd0:  09 7d 0a 23 69 66 20 30 0a 0a 54 68 69 73 20 77 ·}·#if 0··This w
00000fe0:  68 69 6c 65 20 6c 6f 6f 70 20 69 73 20 6d 65 61 hile loop is mea
00000ff0:  6e 74 20 66 6f 72 0a 0a 61 20 6c 69 6e 65 20 74 nt for··a line t
00001000:  68 61 74 20 69 73 20 65 71 75 61 6c 20 74 6f 0a hat is equal to·
00001010:  0a 4e 55 4d 5f 42 49 4e 5f 52 4f 57 53 0a 0a 23 ·NUM_BIN_ROWS··#
00001020:  65 6e 64 69 66 09 0a 0a 09 09 09 69 66 20 28 20 endif······if ( 
00001030:  69 6e 64 65 78 20 25 20 4e 55 4d 5f 42 49 4e 5f index % NUM_BIN_
00001040:  52 4f 57 53 20 3d 3d 20 30 20 29 0a 09 09 09 7b ROWS == 0 )····{
00001050:  0a 09 09 09 09 66 70 75 74 63 28 30 78 32 30 2c ·····fputc(0x20,
00001060:  6f 75 74 29 3b 0a 09 09 09 7d 09 0a 09 0a 09 09 out);····}······
00001070:  7d 0a 0a 09 0a 0a 09 69 66 20 28 20 69 20 3d 3d }······if ( i ==
00001080:  20 46 49 4c 45 5f 53 49 5a 45 20 26 26 20 28 69  FILE_SIZE && (i
00001090:  25 4e 55 4d 5f 42 49 4e 5f 52 4f 57 53 29 20 21 %NUM_BIN_ROWS) !
000010a0:  3d 20 30 20 20 29 0a 09 7b 0a 0a 09 09 09 09 72 = 0  )··{······r
000010b0:  73 69 7a 65 5f 74 20 73 70 61 63 65 5f 61 6c 69 size_t space_ali
000010c0:  67 6e 20 3d 20 69 3b 0a 09 09 09 09 0a 09 09 09 gn = i;·········
000010d0:  09 66 70 6f 73 20 3d 20 66 74 65 6c 6c 28 69 6e ·fpos = ftell(in
000010e0:  29 3b 0a 09 09 09 09 0a 09 09 09 09 66 73 65 65 );··········fsee
000010f0:  6b 28 69 6e 2c 2d 28 69 25 4e 55 4d 5f 42 49 4e k(in,-(i%NUM_BIN
00001100:  5f 52 4f 57 53 29 2c 53 45 45 4b 5f 43 55 52 29 _ROWS),SEEK_CUR)
00001110:  3b 0a 0a 09 09 09 09 75 20 3d 20 30 3b 09 09 09 ;······u = 0;···
00001120:  09 0a 09 09 09 09 0a 09 09 09 09 77 68 69 6c 65 ···········while
00001130:  20 28 20 0a 09 09 09 09 09 0a 09 09 09 09 09 75  ( ············u
00001140:  20 3c 20 28 20 69 25 4e 55 4d 5f 42 49 4e 5f 52  < ( i%NUM_BIN_R
00001150:  4f 57 53 20 29 0a 0a 09 09 09 09 20 20 20 20 20 OWS )······     
00001160:  20 29 0a 09 09 09 09 7b 0a 09 09 09 09 09 28 20  )·····{······( 
00001170:  63 20 3d 20 66 67 65 74 63 28 69 6e 29 20 29 3b c = fgetc(in) );
00001180:  09 0a 09 09 09 09 09 0a 09 09 09 09 09 63 6f 6c ·············col
00001190:  6f 72 63 68 61 72 28 63 29 3b 09 0a 0a 09 09 09 orchar(c);······
000011a0:  09 09 69 66 20 28 20 69 73 70 72 69 6e 74 28 63 ··if ( isprint(c
000011b0:  29 20 29 0a 09 09 09 09 09 7b 09 0a 09 09 09 09 ) )······{······
000011c0:  09 09 66 70 75 74 63 28 63 2c 6f 75 74 29 3b 0a ··fputc(c,out);·
000011d0:  09 09 09 09 09 7d 0a 0a 09 09 09 09 09 65 6c 73 ·····}·······els
000011e0:  65 0a 09 09 09 09 09 7b 0a 09 09 09 09 09 09 66 e······{·······f
000011f0:  70 72 69 6e 74 66 28 6f 75 74 2c 22 5c 75 30 30 printf(out,"\u00
00001200:  62 37 22 29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 b7");······}····
00001210:  09 09 09 75 2b 2b 3b 0a 0a 09 09 09 09 09 72 65 ···u++;·······re
00001220:  73 65 74 63 6f 6c 6f 72 28 29 3b 0a 09 09 09 09 setcolor();·····
00001230:  7d 0a 0a 09 09 09 09 66 73 65 65 6b 28 69 6e 2c }······fseek(in,
00001240:  66 70 6f 73 2c 53 45 45 4b 5f 53 45 54 29 3b 0a fpos,SEEK_SET);·
00001250:  09 09 09 0a 09 7d 0a 09 0a 09 65 6c 73 65 20 2f ·····}····else /
00001260:  2f 20 28 20 69 20 3d 3d 20 46 49 4c 45 5f 53 49 / ( i == FILE_SI
00001270:  5a 45 20 26 26 20 28 69 25 4e 55 4d 5f 42 49 4e ZE && (i%NUM_BIN
00001280:  5f 52 4f 57 53 29 20 3d 3d 20 30 20 20 29 0a 09 _ROWS) == 0  )··
00001290:  7b 0a 0a 09 09 09 09 72 73 69 7a 65 5f 74 20 73 {······rsize_t s
000012a0:  70 61 63 65 5f 61 6c 69 67 6e 20 3d 20 69 3b 0a pace_align = i;·
000012b0:  09 09 09 09 0a 09 09 09 09 66 70 6f 73 20 3d 20 ·········fpos = 
000012c0:  66 74 65 6c 6c 28 69 6e 29 3b 0a 09 09 09 09 0a ftell(in);······
000012d0:  09 09 09 09 66 73 65 65 6b 28 69 6e 2c 2d 28 4e ····fseek(in,-(N
000012e0:  55 4d 5f 42 49 4e 5f 52 4f 57 53 29 2c 53 45 45 UM_BIN_ROWS),SEE
000012f0:  4b 5f 43 55 52 29 3b 0a 0a 09 09 09 09 75 20 3d K_CUR);······u =
00001300:  20 30 3b 09 09 09 09 0a 09 09 09 09 0a 09 09 09  0;·············
00001310:  09 77 68 69 6c 65 20 28 20 0a 09 09 09 09 09 0a ·while ( ·······
00001320:  09 09 09 09 09 75 20 3c 20 28 20 4e 55 4d 5f 42 ·····u < ( NUM_B
00001330:  49 4e 5f 52 4f 57 53 20 29 0a 0a 09 09 09 09 20 IN_ROWS )······ 
00001340:  20 20 20 20 20 29 0a 09 09 09 09 7b 0a 09 09 09      )·····{····
00001350:  09 09 28 20 63 20 3d 20 66 67 65 74 63 28 69 6e ··( c = fgetc(in
00001360:  29 20 29 3b 09 0a 0a 09 09 09 09 09 63 6f 6c 6f ) );········colo
00001370:  72 63 68 61 72 28 63 29 3b 0a 09 09 09 09 09 0a rchar(c);·······
00001380:  09 09 09 09 09 69 66 20 28 20 69 73 70 72 69 6e ·····if ( isprin
00001390:  74 28 63 29 20 29 0a 09 09 09 09 09 7b 09 0a 09 t(c) )······{···
000013a0:  09 09 09 09 09 66 70 75 74 63 28 63 2c 6f 75 74 ·····fputc(c,out
000013b0:  29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 09 09 09 );······}·······
000013c0:  65 6c 73 65 0a 09 09 09 09 09 7b 0a 09 09 09 09 else······{·····
000013d0:  09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 5c ··fprintf(out,"\
000013e0:  75 30 30 62 37 22 29 3b 0a 09 09 09 09 09 7d 0a u00b7");······}·
000013f0:  0a 09 09 09 09 09 75 2b 2b 3b 0a 0a 09 09 09 09 ······u++;······
00001400:  09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b 0a 09 ·resetcolor();··
00001410:  09 09 09 7d 0a 0a 09 09 09 09 66 73 65 65 6b 28 ···}······fseek(
00001420:  69 6e 2c 66 70 6f 73 2c 53 45 45 4b 5f 53 45 54 in,fpos,SEEK_SET
00001430:  29 3b 0a 09 09 09 0a 09 7d 0a 0a 7d 0a 0a 76 6f );······}··}··vo
00001440:  69 64 20 70 72 69 6e 74 5f 64 65 63 74 61 62 6c id print_dectabl
00001450:  65 28 46 49 4c 45 20 2a 20 69 6e 2c 20 46 49 4c e(FILE * in, FIL
00001460:  45 20 2a 20 6f 75 74 2c 20 75 6e 73 69 67 6e 65 E * out, unsigne
00001470:  64 20 63 68 61 72 20 41 53 43 49 49 5b 5d 2c 20 d char ASCII[], 
00001480:  63 6f 6e 73 74 20 72 73 69 7a 65 5f 74 20 46 49 const rsize_t FI
00001490:  4c 45 5f 53 49 5a 45 29 0a 7b 0a 09 72 73 69 7a LE_SIZE)·{··rsiz
000014a0:  65 5f 74 20 69 20 3d 20 30 3b 0a 09 0a 09 72 73 e_t i = 0;····rs
000014b0:  69 7a 65 5f 74 20 75 20 3d 20 30 3b 0a 0a 09 75 ize_t u = 0;···u
000014c0:  6e 73 69 67 6e 65 64 20 6c 6f 6e 67 20 66 70 6f nsigned long fpo
000014d0:  73 20 3d 20 30 3b 0a 0a 09 72 73 69 7a 65 5f 74 s = 0;···rsize_t
000014e0:  20 6a 20 3d 20 30 3b 20 2f 2f 6e 65 65 64 20 74  j = 0; //need t
000014f0:  68 69 73 20 74 6f 20 63 72 65 61 74 65 20 70 72 his to create pr
00001500:  69 6e 74 61 62 6c 65 20 41 53 43 49 49 20 69 6e intable ASCII in
00001510:  20 6f 75 74 70 75 74 0a 0a 09 75 6e 73 69 67 6e  output···unsign
00001520:  65 64 20 63 68 61 72 20 63 20 3d 20 30 3b 0a 0a ed char c = 0;··
00001530:  09 77 68 69 6c 65 20 28 20 69 20 3c 20 46 49 4c ·while ( i < FIL
00001540:  45 5f 53 49 5a 45 20 29 0a 09 7b 0a 09 09 63 20 E_SIZE )··{···c 
00001550:  3d 20 66 67 65 74 63 28 69 6e 29 3b 0a 0a 09 09 = fgetc(in);····
00001560:  63 6f 6c 6f 72 63 68 61 72 28 63 29 3b 09 0a 23 colorchar(c);··#
00001570:  69 66 20 30 0a 0a 54 68 69 73 20 70 72 69 6e 74 if 0··This print
00001580:  66 20 61 63 74 75 61 6c 6c 79 20 66 6f 72 63 65 f actually force
00001590:  73 20 70 72 69 6e 74 69 6e 67 20 6f 66 20 41 53 s printing of AS
000015a0:  43 49 49 2e 0a 0a 23 65 6e 64 69 66 09 0a 0a 09 CII.··#endif····
000015b0:  09 69 66 20 28 20 69 20 3d 3d 20 30 20 29 0a 09 ·if ( i == 0 )··
000015c0:  09 7b 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ·{ fprintf(out,"
000015d0:  25 30 38 78 3a 25 63 22 2c 69 2c 30 78 32 30 29 %08x:%c",i,0x20)
000015e0:  3b 20 7d 0a 0a 0a 09 09 65 6c 73 65 20 69 66 20 ; }·····else if 
000015f0:  28 20 28 69 25 4e 55 4d 5f 44 45 43 5f 52 4f 57 ( (i%NUM_DEC_ROW
00001600:  53 29 20 3d 3d 20 30 20 20 29 0a 09 09 7b 0a 09 S) == 0  )···{··
00001610:  09 09 09 66 70 75 74 63 28 30 78 32 30 2c 6f 75 ···fputc(0x20,ou
00001620:  74 29 3b 0a 09 09 09 09 0a 09 09 09 09 69 66 20 t);··········if 
00001630:  28 20 69 20 3e 3d 20 4e 55 4d 5f 44 45 43 5f 52 ( i >= NUM_DEC_R
00001640:  4f 57 53 20 29 0a 09 09 09 09 7b 09 0a 09 09 09 OWS )·····{·····
00001650:  09 0a 09 09 09 09 09 66 73 65 65 6b 28 69 6e 2c ·······fseek(in,
00001660:  2d 4e 55 4d 5f 44 45 43 5f 52 4f 57 53 2d 31 2c -NUM_DEC_ROWS-1,
00001670:  53 45 45 4b 5f 43 55 52 29 3b 0a 0a 09 09 09 09 SEEK_CUR);······
00001680:  7d 0a 0a 09 09 09 09 65 6c 73 65 0a 09 09 09 09 }······else·····
00001690:  7b 0a 09 09 09 09 09 66 73 65 65 6b 28 69 6e 2c {······fseek(in,
000016a0:  30 2c 53 45 45 4b 5f 53 45 54 29 3b 09 0a 09 09 0,SEEK_SET);····
000016b0:  09 09 7d 0a 0a 09 09 09 09 75 20 3d 20 30 3b 09 ··}······u = 0;·
000016c0:  09 09 09 0a 09 09 09 09 0a 09 09 09 09 77 68 69 ·············whi
000016d0:  6c 65 20 28 20 0a 09 09 09 09 09 0a 09 09 09 09 le ( ···········
000016e0:  09 75 20 3c 20 4e 55 4d 5f 44 45 43 5f 52 4f 57 ·u < NUM_DEC_ROW
000016f0:  53 0a 0a 09 09 09 09 09 09 09 0a 09 09 09 09 20 S·············· 
00001700:  20 20 20 20 20 29 0a 09 09 09 09 7b 0a 09 09 09      )·····{····
00001710:  09 09 28 20 63 20 3d 20 66 67 65 74 63 28 69 6e ··( c = fgetc(in
00001720:  29 20 29 3b 09 0a 0a 09 09 09 09 09 63 6f 6c 6f ) );········colo
00001730:  72 63 68 61 72 28 63 29 3b 0a 09 09 09 09 09 0a rchar(c);·······
00001740:  09 09 09 09 09 69 66 20 28 20 69 73 70 72 69 6e ·····if ( isprin
00001750:  74 28 63 29 20 29 0a 09 09 09 09 09 7b 09 0a 09 t(c) )······{···
00001760:  09 09 09 09 09 66 70 75 74 63 28 63 2c 6f 75 74 ·····fputc(c,out
00001770:  29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 09 09 09 );······}·······
00001780:  65 6c 73 65 0a 09 09 09 09 09 7b 0a 09 09 09 09 else······{·····
00001790:  09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 5c ··fprintf(out,"\
000017a0:  75 30 30 62 37 22 29 3b 0a 09 09 09 09 09 7d 0a u00b7");······}·
000017b0:  0a 09 09 09 09 09 75 2b 2b 3b 0a 0a 09 09 09 09 ······u++;······
000017c0:  09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b 0a 09 ·resetcolor();··
000017d0:  09 09 09 7d 0a 0a 09 09 09 09 63 20 3d 20 66 67 ···}······c = fg
000017e0:  65 74 63 28 69 6e 29 3b 20 2f 2f 63 61 74 63 68 etc(in); //catch
000017f0:  20 75 70 20 74 6f 20 6c 61 74 65 73 74 20 72 6f  up to latest ro
00001800:  77 0a 0a 09 09 09 09 63 6f 6c 6f 72 63 68 61 72 w······colorchar
00001810:  28 63 29 3b 0a 09 09 09 09 0a 09 09 09 09 66 70 (c);··········fp
00001820:  72 69 6e 74 66 28 6f 75 74 2c 22 5c 6e 25 30 38 rintf(out,"\n%08
00001830:  78 3a 25 63 22 2c 69 2c 30 78 32 30 29 3b 0a 09 x:%c",i,0x20);··
00001840:  09 09 09 0a 09 09 09 09 72 65 73 65 74 63 6f 6c ········resetcol
00001850:  6f 72 28 29 3b 09 0a 09 09 7d 0a 0a 09 09 63 6f or();····}····co
00001860:  6c 6f 72 63 68 61 72 28 63 29 3b 0a 0a 09 09 0a lorchar(c);·····
00001870:  09 09 28 69 25 31 20 21 3d 20 30 29 20 3f 20 28 ··(i%1 != 0) ? (
00001880:  20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 25 30  fprintf(out,"%0
00001890:  33 75 22 2c 63 29 20 29 20 3a 20 28 20 66 70 72 3u",c) ) : ( fpr
000018a0:  69 6e 74 66 28 6f 75 74 2c 22 25 63 25 30 33 75 intf(out,"%c%03u
000018b0:  22 2c 30 78 32 30 2c 63 29 20 29 3b 0a 09 09 0a ",0x20,c) );····
000018c0:  09 09 69 2b 2b 3b 09 0a 09 09 0a 09 09 72 65 73 ··i++;·······res
000018d0:  65 74 63 6f 6c 6f 72 28 29 3b 0a 0a 09 09 2f 2f etcolor();····//
000018e0:  20 42 75 67 3a 20 57 72 69 74 65 20 63 6f 64 65  Bug: Write code
000018f0:  20 74 6f 20 70 6c 61 63 65 20 66 66 20 61 6e 64  to place ff and
00001900:  20 65 78 74 72 61 20 73 70 61 63 65 73 20 74 6f  extra spaces to
00001910:  20 61 6c 69 67 6e 20 6c 61 73 74 20 41 53 43 49  align last ASCI
00001920:  49 20 6c 69 6e 65 20 68 65 72 65 0a 09 7d 0a 0a I line here··}··
00001930:  09 09 69 66 20 28 20 69 20 3d 3d 20 46 49 4c 45 ··if ( i == FILE
00001940:  5f 53 49 5a 45 20 29 0a 09 09 7b 0a 09 09 09 72 _SIZE )···{····r
00001950:  73 69 7a 65 5f 74 20 69 6e 64 65 78 20 3d 20 69 size_t index = i
00001960:  3b 0a 0a 09 09 09 77 68 69 6c 65 20 28 20 69 6e ;·····while ( in
00001970:  64 65 78 20 25 20 4e 55 4d 5f 44 45 43 5f 52 4f dex % NUM_DEC_RO
00001980:  57 53 20 21 3d 20 30 20 29 20 0a 09 09 09 7b 0a WS != 0 ) ····{·
00001990:  09 09 09 09 0a 09 09 09 09 0a 09 09 09 09 28 69 ··············(i
000019a0:  6e 64 65 78 25 32 20 3d 3d 20 30 29 20 0a 09 09 ndex%2 == 0) ···
000019b0:  09 09 09 0a 09 09 09 09 09 3f 20 0a 09 09 09 09 ·········? ·····
000019c0:  09 0a 09 09 09 09 09 28 20 66 70 72 69 6e 74 66 ·······( fprintf
000019d0:  28 6f 75 74 2c 22 25 63 25 63 25 63 25 63 22 2c (out,"%c%c%c%c",
000019e0:  30 78 32 30 2c 30 78 32 30 2c 30 78 32 30 2c 30 0x20,0x20,0x20,0
000019f0:  78 32 30 29 20 29 20 0a 09 09 09 09 09 0a 09 09 x20) ) ·········
00001a00:  09 09 09 3a 20 0a 09 09 09 09 09 0a 09 09 09 09 ···: ···········
00001a10:  09 28 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ·( fprintf(out,"
00001a20:  25 63 25 63 25 63 25 63 22 2c 30 78 32 30 2c 30 %c%c%c%c",0x20,0
00001a30:  78 32 30 2c 30 78 32 30 2c 30 78 32 30 29 20 29 x20,0x20,0x20) )
00001a40:  3b 0a 09 09 09 09 0a 09 09 09 09 69 6e 64 65 78 ;··········index
00001a50:  2b 2b 3b 0a 09 09 09 7d 0a 23 69 66 20 30 0a 0a ++;····}·#if 0··
00001a60:  54 68 69 73 20 77 68 69 6c 65 20 6c 6f 6f 70 20 This while loop 
00001a70:  69 73 20 6d 65 61 6e 74 20 66 6f 72 0a 0a 61 20 is meant for··a 
00001a80:  6c 69 6e 65 20 74 68 61 74 20 69 73 20 65 71 75 line that is equ
00001a90:  61 6c 20 74 6f 0a 0a 4e 55 4d 5f 44 45 43 5f 52 al to··NUM_DEC_R
00001aa0:  4f 57 53 0a 0a 23 65 6e 64 69 66 09 0a 0a 09 09 OWS··#endif·····
00001ab0:  09 69 66 20 28 20 69 6e 64 65 78 20 25 20 4e 55 ·if ( index % NU
00001ac0:  4d 5f 44 45 43 5f 52 4f 57 53 20 3d 3d 20 30 20 M_DEC_ROWS == 0 
00001ad0:  29 0a 09 09 09 7b 0a 09 09 09 09 66 70 75 74 63 )····{·····fputc
00001ae0:  28 30 78 32 30 2c 6f 75 74 29 3b 0a 09 09 09 7d (0x20,out);····}
00001af0:  09 0a 09 0a 09 09 7d 0a 0a 09 0a 0a 09 69 66 20 ······}······if 
00001b00:  28 20 69 20 3d 3d 20 46 49 4c 45 5f 53 49 5a 45 ( i == FILE_SIZE
00001b10:  20 26 26 20 28 69 25 4e 55 4d 5f 44 45 43 5f 52  && (i%NUM_DEC_R
00001b20:  4f 57 53 29 20 21 3d 20 30 20 20 29 0a 09 7b 0a OWS) != 0  )··{·
00001b30:  0a 09 09 09 09 72 73 69 7a 65 5f 74 20 73 70 61 ·····rsize_t spa
00001b40:  63 65 5f 61 6c 69 67 6e 20 3d 20 69 3b 0a 09 09 ce_align = i;···
00001b50:  09 09 0a 09 09 09 09 66 70 6f 73 20 3d 20 66 74 ·······fpos = ft
00001b60:  65 6c 6c 28 69 6e 29 3b 0a 09 09 09 09 0a 09 09 ell(in);········
00001b70:  09 09 66 73 65 65 6b 28 69 6e 2c 2d 28 69 25 4e ··fseek(in,-(i%N
00001b80:  55 4d 5f 44 45 43 5f 52 4f 57 53 29 2c 53 45 45 UM_DEC_ROWS),SEE
00001b90:  4b 5f 43 55 52 29 3b 0a 0a 09 09 09 09 75 20 3d K_CUR);······u =
00001ba0:  20 30 3b 09 09 09 09 0a 09 09 09 09 0a 09 09 09  0;·············
00001bb0:  09 77 68 69 6c 65 20 28 20 0a 09 09 09 09 09 0a ·while ( ·······
00001bc0:  09 09 09 09 09 75 20 3c 20 28 20 69 25 4e 55 4d ·····u < ( i%NUM
00001bd0:  5f 44 45 43 5f 52 4f 57 53 20 29 0a 0a 09 09 09 _DEC_ROWS )·····
00001be0:  09 20 20 20 20 20 20 29 0a 09 09 09 09 7b 0a 09 ·      )·····{··
00001bf0:  09 09 09 09 28 20 63 20 3d 20 66 67 65 74 63 28 ····( c = fgetc(
00001c00:  69 6e 29 20 29 3b 09 0a 09 09 09 09 09 0a 09 09 in) );··········
00001c10:  09 09 09 63 6f 6c 6f 72 63 68 61 72 28 63 29 3b ···colorchar(c);
00001c20:  0a 0a 09 09 09 09 09 69 66 20 28 20 69 73 70 72 ·······if ( ispr
00001c30:  69 6e 74 28 63 29 20 29 0a 09 09 09 09 09 7b 09 int(c) )······{·
00001c40:  0a 09 09 09 09 09 09 66 70 75 74 63 28 63 2c 6f ·······fputc(c,o
00001c50:  75 74 29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 09 ut);······}·····
00001c60:  09 09 65 6c 73 65 0a 09 09 09 09 09 7b 0a 09 09 ··else······{···
00001c70:  09 09 09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c ····fprintf(out,
00001c80:  22 5c 75 30 30 62 37 22 29 3b 0a 09 09 09 09 09 "\u00b7");······
00001c90:  7d 0a 0a 09 09 09 09 09 75 2b 2b 3b 0a 0a 09 09 }·······u++;····
00001ca0:  09 09 09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b ···resetcolor();
00001cb0:  0a 09 09 09 09 7d 0a 0a 09 09 09 09 66 73 65 65 ·····}······fsee
00001cc0:  6b 28 69 6e 2c 66 70 6f 73 2c 53 45 45 4b 5f 53 k(in,fpos,SEEK_S
00001cd0:  45 54 29 3b 0a 09 09 09 0a 09 7d 0a 09 0a 09 65 ET);······}····e
00001ce0:  6c 73 65 20 2f 2f 20 28 20 69 20 3d 3d 20 46 49 lse // ( i == FI
00001cf0:  4c 45 5f 53 49 5a 45 20 26 26 20 28 69 25 4e 55 LE_SIZE && (i%NU
00001d00:  4d 5f 44 45 43 5f 52 4f 57 53 29 20 3d 3d 20 30 M_DEC_ROWS) == 0
00001d10:  20 20 29 0a 09 7b 0a 0a 09 09 09 09 72 73 69 7a   )··{······rsiz
00001d20:  65 5f 74 20 73 70 61 63 65 5f 61 6c 69 67 6e 20 e_t space_align 
00001d30:  3d 20 69 3b 0a 09 09 09 09 0a 09 09 09 09 66 70 = i;··········fp
00001d40:  6f 73 20 3d 20 66 74 65 6c 6c 28 69 6e 29 3b 0a os = ftell(in);·
00001d50:  09 09 09 09 0a 09 09 09 09 66 73 65 65 6b 28 69 ·········fseek(i
00001d60:  6e 2c 2d 28 4e 55 4d 5f 44 45 43 5f 52 4f 57 53 n,-(NUM_DEC_ROWS
00001d70:  29 2c 53 45 45 4b 5f 43 55 52 29 3b 0a 0a 09 09 ),SEEK_CUR);····
00001d80:  09 09 75 20 3d 20 30 3b 09 09 09 09 0a 09 09 09 ··u = 0;········
00001d90:  09 0a 09 09 09 09 77 68 69 6c 65 20 28 20 0a 09 ······while ( ··
00001da0:  09 09 09 09 0a 09 09 09 09 09 75 20 3c 20 28 20 ··········u < ( 
00001db0:  4e 55 4d 5f 44 45 43 5f 52 4f 57 53 20 29 0a 0a NUM_DEC_ROWS )··
00001dc0:  09 09 09 09 20 20 20 20 20 20 29 0a 09 09 09 09 ····      )·····
00001dd0:  7b 0a 09 09 09 09 09 28 20 63 20 3d 20 66 67 65 {······( c = fge
00001de0:  74 63 28 69 6e 29 20 29 3b 09 0a 09 09 09 09 09 tc(in) );·······
00001df0:  0a 09 09 09 09 09 63 6f 6c 6f 72 63 68 61 72 28 ······colorchar(
00001e00:  63 29 3b 0a 0a 09 09 09 09 09 69 66 20 28 20 69 c);·······if ( i
00001e10:  73 70 72 69 6e 74 28 63 29 20 29 0a 09 09 09 09 sprint(c) )·····
00001e20:  09 7b 09 0a 09 09 09 09 09 09 66 70 75 74 63 28 ·{········fputc(
00001e30:  63 2c 6f 75 74 29 3b 0a 09 09 09 09 09 7d 0a 0a c,out);······}··
00001e40:  09 09 09 09 09 65 6c 73 65 0a 09 09 09 09 09 7b ·····else······{
00001e50:  0a 09 09 09 09 09 09 66 70 72 69 6e 74 66 28 6f ·······fprintf(o
00001e60:  75 74 2c 22 5c 75 30 30 62 37 22 29 3b 0a 09 09 ut,"\u00b7");···
00001e70:  09 09 09 7d 0a 0a 09 09 09 09 09 75 2b 2b 3b 0a ···}·······u++;·
00001e80:  0a 09 09 09 09 09 72 65 73 65 74 63 6f 6c 6f 72 ······resetcolor
00001e90:  28 29 3b 0a 09 09 09 09 7d 0a 0a 09 09 09 09 66 ();·····}······f
00001ea0:  73 65 65 6b 28 69 6e 2c 66 70 6f 73 2c 53 45 45 seek(in,fpos,SEE
00001eb0:  4b 5f 53 45 54 29 3b 0a 09 09 09 0a 09 7d 0a 0a K_SET);······}··
00001ec0:  7d 0a 0a 76 6f 69 64 20 70 72 69 6e 74 5f 6f 63 }··void print_oc
00001ed0:  74 74 61 62 6c 65 28 46 49 4c 45 20 2a 20 69 6e ttable(FILE * in
00001ee0:  2c 20 46 49 4c 45 20 2a 20 6f 75 74 2c 20 75 6e , FILE * out, un
00001ef0:  73 69 67 6e 65 64 20 63 68 61 72 20 41 53 43 49 signed char ASCI
00001f00:  49 5b 5d 2c 20 63 6f 6e 73 74 20 72 73 69 7a 65 I[], const rsize
00001f10:  5f 74 20 46 49 4c 45 5f 53 49 5a 45 29 0a 7b 0a _t FILE_SIZE)·{·
00001f20:  09 72 73 69 7a 65 5f 74 20 69 20 3d 20 30 3b 0a ·rsize_t i = 0;·
00001f30:  09 0a 09 72 73 69 7a 65 5f 74 20 75 20 3d 20 30 ···rsize_t u = 0
00001f40:  3b 0a 0a 09 75 6e 73 69 67 6e 65 64 20 6c 6f 6e ;···unsigned lon
00001f50:  67 20 66 70 6f 73 20 3d 20 30 3b 0a 0a 09 72 73 g fpos = 0;···rs
00001f60:  69 7a 65 5f 74 20 6a 20 3d 20 30 3b 20 2f 2f 6e ize_t j = 0; //n
00001f70:  65 65 64 20 74 68 69 73 20 74 6f 20 63 72 65 61 eed this to crea
00001f80:  74 65 20 70 72 69 6e 74 61 62 6c 65 20 41 53 43 te printable ASC
00001f90:  49 49 20 69 6e 20 6f 75 74 70 75 74 0a 0a 09 75 II in output···u
00001fa0:  6e 73 69 67 6e 65 64 20 63 68 61 72 20 63 20 3d nsigned char c =
00001fb0:  20 30 3b 0a 0a 09 77 68 69 6c 65 20 28 20 69 20  0;···while ( i 
00001fc0:  3c 20 46 49 4c 45 5f 53 49 5a 45 20 29 0a 09 7b < FILE_SIZE )··{
00001fd0:  0a 09 09 63 20 3d 20 66 67 65 74 63 28 69 6e 29 ···c = fgetc(in)
00001fe0:  3b 0a 0a 09 09 63 6f 6c 6f 72 63 68 61 72 28 63 ;····colorchar(c
00001ff0:  29 3b 09 0a 23 69 66 20 30 0a 0a 54 68 69 73 20 );··#if 0··This 
00002000:  70 72 69 6e 74 66 20 61 63 74 75 61 6c 6c 79 20 printf actually 
00002010:  66 6f 72 63 65 73 20 70 72 69 6e 74 69 6e 67 20 forces printing 
00002020:  6f 66 20 41 53 43 49 49 2e 0a 0a 23 65 6e 64 69 of ASCII.··#endi
00002030:  66 09 0a 0a 09 09 69 66 20 28 20 69 20 3d 3d 20 f·····if ( i == 
00002040:  30 20 29 0a 09 09 7b 20 66 70 72 69 6e 74 66 28 0 )···{ fprintf(
00002050:  6f 75 74 2c 22 25 30 38 78 3a 25 63 22 2c 69 2c out,"%08x:%c",i,
00002060:  30 78 32 30 29 3b 20 7d 0a 0a 0a 09 09 65 6c 73 0x20); }·····els
00002070:  65 20 69 66 20 28 20 28 69 25 4e 55 4d 5f 4f 43 e if ( (i%NUM_OC
00002080:  54 5f 52 4f 57 53 29 20 3d 3d 20 30 20 20 29 0a T_ROWS) == 0  )·
00002090:  09 09 7b 0a 09 09 09 09 66 70 75 74 63 28 30 78 ··{·····fputc(0x
000020a0:  32 30 2c 6f 75 74 29 3b 0a 09 09 09 09 0a 09 09 20,out);········
000020b0:  09 09 69 66 20 28 20 69 20 3e 3d 20 4e 55 4d 5f ··if ( i >= NUM_
000020c0:  4f 43 54 5f 52 4f 57 53 20 29 0a 09 09 09 09 7b OCT_ROWS )·····{
000020d0:  09 0a 09 09 09 09 0a 09 09 09 09 09 66 73 65 65 ············fsee
000020e0:  6b 28 69 6e 2c 2d 4e 55 4d 5f 4f 43 54 5f 52 4f k(in,-NUM_OCT_RO
000020f0:  57 53 2d 31 2c 53 45 45 4b 5f 43 55 52 29 3b 0a WS-1,SEEK_CUR);·
00002100:  0a 09 09 09 09 7d 0a 0a 09 09 09 09 65 6c 73 65 ·····}······else
00002110:  0a 09 09 09 09 7b 0a 09 09 09 09 09 66 73 65 65 ·····{······fsee
00002120:  6b 28 69 6e 2c 30 2c 53 45 45 4b 5f 53 45 54 29 k(in,0,SEEK_SET)
00002130:  3b 09 0a 09 09 09 09 7d 0a 0a 09 09 09 09 75 20 ;······}······u 
00002140:  3d 20 30 3b 09 09 09 09 0a 09 09 09 09 0a 09 09 = 0;············
00002150:  09 09 77 68 69 6c 65 20 28 20 0a 09 09 09 09 09 ··while ( ······
00002160:  0a 09 09 09 09 09 75 20 3c 20 4e 55 4d 5f 4f 43 ······u < NUM_OC
00002170:  54 5f 52 4f 57 53 0a 0a 09 09 09 09 09 09 09 0a T_ROWS··········
00002180:  09 09 09 09 20 20 20 20 20 20 29 0a 09 09 09 09 ····      )·····
00002190:  7b 0a 09 09 09 09 09 28 20 63 20 3d 20 66 67 65 {······( c = fge
000021a0:  74 63 28 69 6e 29 20 29 3b 09 0a 0a 09 09 09 09 tc(in) );·······
000021b0:  09 63 6f 6c 6f 72 63 68 61 72 28 63 29 3b 0a 09 ·colorchar(c);··
000021c0:  09 09 09 09 0a 09 09 09 09 09 69 66 20 28 20 69 ··········if ( i
000021d0:  73 70 72 69 6e 74 28 63 29 20 29 0a 09 09 09 09 sprint(c) )·····
000021e0:  09 7b 09 0a 09 09 09 09 09 09 66 70 75 74 63 28 ·{········fputc(
000021f0:  63 2c 6f 75 74 29 3b 0a 09 09 09 09 09 7d 0a 0a c,out);······}··
00002200:  09 09 09 09 09 65 6c 73 65 0a 09 09 09 09 09 7b ·····else······{
00002210:  0a 09 09 09 09 09 09 66 70 72 69 6e 74 66 28 6f ·······fprintf(o
00002220:  75 74 2c 22 5c 75 30 30 62 37 22 29 3b 0a 09 09 ut,"\u00b7");···
00002230:  09 09 09 7d 0a 0a 09 09 09 09 09 75 2b 2b 3b 0a ···}·······u++;·
00002240:  0a 09 09 09 09 09 72 65 73 65 74 63 6f 6c 6f 72 ······resetcolor
00002250:  28 29 3b 0a 09 09 09 09 7d 0a 0a 09 09 09 09 63 ();·····}······c
00002260:  20 3d 20 66 67 65 74 63 28 69 6e 29 3b 20 2f 2f  = fgetc(in); //
00002270:  63 61 74 63 68 20 75 70 20 74 6f 20 6c 61 74 65 catch up to late
00002280:  73 74 20 72 6f 77 0a 0a 09 09 09 09 63 6f 6c 6f st row······colo
00002290:  72 63 68 61 72 28 63 29 3b 0a 09 09 09 09 0a 09 rchar(c);·······
000022a0:  09 09 09 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ···fprintf(out,"
000022b0:  5c 6e 25 30 38 78 3a 25 63 22 2c 69 2c 30 78 32 \n%08x:%c",i,0x2
000022c0:  30 29 3b 0a 09 09 09 09 0a 09 09 09 09 72 65 73 0);··········res
000022d0:  65 74 63 6f 6c 6f 72 28 29 3b 09 0a 09 09 7d 0a etcolor();····}·
000022e0:  0a 09 09 63 6f 6c 6f 72 63 68 61 72 28 63 29 3b ···colorchar(c);
000022f0:  0a 0a 09 09 0a 09 09 28 69 25 31 20 21 3d 20 30 ·······(i%1 != 0
00002300:  29 20 3f 20 28 20 66 70 72 69 6e 74 66 28 6f 75 ) ? ( fprintf(ou
00002310:  74 2c 22 25 30 33 6f 22 2c 63 29 20 29 20 3a 20 t,"%03o",c) ) : 
00002320:  28 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 25 ( fprintf(out,"%
00002330:  63 25 30 33 6f 22 2c 30 78 32 30 2c 63 29 20 29 c%03o",0x20,c) )
00002340:  3b 0a 09 09 0a 09 09 69 2b 2b 3b 09 0a 09 09 0a ;······i++;·····
00002350:  09 09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b 0a ··resetcolor();·
00002360:  0a 09 09 2f 2f 20 42 75 67 3a 20 57 72 69 74 65 ···// Bug: Write
00002370:  20 63 6f 64 65 20 74 6f 20 70 6c 61 63 65 20 66  code to place f
00002380:  66 20 61 6e 64 20 65 78 74 72 61 20 73 70 61 63 f and extra spac
00002390:  65 73 20 74 6f 20 61 6c 69 67 6e 20 6c 61 73 74 es to align last
000023a0:  20 41 53 43 49 49 20 6c 69 6e 65 20 68 65 72 65  ASCII line here
000023b0:  0a 09 7d 0a 0a 09 09 69 66 20 28 20 69 20 3d 3d ··}····if ( i ==
000023c0:  20 46 49 4c 45 5f 53 49 5a 45 20 29 0a 09 09 7b  FILE_SIZE )···{
000023d0:  0a 09 09 09 72 73 69 7a 65 5f 74 20 69 6e 64 65 ····rsize_t inde
000023e0:  78 20 3d 20 69 3b 0a 0a 09 09 09 77 68 69 6c 65 x = i;·····while
000023f0:  20 28 20 69 6e 64 65 78 20 25 20 4e 55 4d 5f 4f  ( index % NUM_O
00002400:  43 54 5f 52 4f 57 53 20 21 3d 20 30 20 29 20 0a CT_ROWS != 0 ) ·
00002410:  09 09 09 7b 0a 09 09 09 09 0a 09 09 09 09 0a 09 ···{············
00002420:  09 09 09 28 69 6e 64 65 78 25 32 20 3d 3d 20 30 ···(index%2 == 0
00002430:  29 20 0a 09 09 09 09 09 0a 09 09 09 09 09 3f 20 ) ············? 
00002440:  0a 09 09 09 09 09 0a 09 09 09 09 09 28 20 66 70 ············( fp
00002450:  72 69 6e 74 66 28 6f 75 74 2c 22 25 63 25 63 25 rintf(out,"%c%c%
00002460:  63 25 63 22 2c 30 78 32 30 2c 30 78 32 30 2c 30 c%c",0x20,0x20,0
00002470:  78 32 30 2c 30 78 32 30 29 20 29 20 0a 09 09 09 x20,0x20) ) ····
00002480:  09 09 0a 09 09 09 09 09 3a 20 0a 09 09 09 09 09 ········: ······
00002490:  0a 09 09 09 09 09 28 20 66 70 72 69 6e 74 66 28 ······( fprintf(
000024a0:  6f 75 74 2c 22 25 63 25 63 25 63 25 63 22 2c 30 out,"%c%c%c%c",0
000024b0:  78 32 30 2c 30 78 32 30 2c 30 78 32 30 2c 30 78 x20,0x20,0x20,0x
000024c0:  32 30 29 20 29 3b 0a 09 09 09 09 0a 09 09 09 09 20) );··········
000024d0:  69 6e 64 65 78 2b 2b 3b 0a 09 09 09 7d 0a 23 69 index++;····}·#i
000024e0:  66 20 30 0a 0a 54 68 69 73 20 77 68 69 6c 65 20 f 0··This while 
000024f0:  6c 6f 6f 70 20 69 73 20 6d 65 61 6e 74 20 66 6f loop is meant fo
00002500:  72 0a 0a 61 20 6c 69 6e 65 20 74 68 61 74 20 69 r··a line that i
00002510:  73 20 65 71 75 61 6c 20 74 6f 0a 0a 4e 55 4d 5f s equal to··NUM_
00002520:  4f 43 54 5f 52 4f 57 53 0a 0a 23 65 6e 64 69 66 OCT_ROWS··#endif
00002530:  09 0a 0a 09 09 09 69 66 20 28 20 69 6e 64 65 78 ······if ( index
00002540:  20 25 20 4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 20  % NUM_OCT_ROWS 
00002550:  3d 3d 20 30 20 29 0a 09 09 09 7b 0a 09 09 09 09 == 0 )····{·····
00002560:  66 70 75 74 63 28 30 78 32 30 2c 6f 75 74 29 3b fputc(0x20,out);
00002570:  0a 09 09 09 7d 09 0a 09 0a 09 09 7d 0a 0a 09 0a ····}······}····
00002580:  0a 09 69 66 20 28 20 69 20 3d 3d 20 46 49 4c 45 ··if ( i == FILE
00002590:  5f 53 49 5a 45 20 26 26 20 28 69 25 4e 55 4d 5f _SIZE && (i%NUM_
000025a0:  4f 43 54 5f 52 4f 57 53 29 20 21 3d 20 30 20 20 OCT_ROWS) != 0  
000025b0:  29 0a 09 7b 0a 0a 09 09 09 09 72 73 69 7a 65 5f )··{······rsize_
000025c0:  74 20 73 70 61 63 65 5f 61 6c 69 67 6e 20 3d 20 t space_align = 
000025d0:  69 3b 0a 09 09 09 09 0a 09 09 09 09 66 70 6f 73 i;··········fpos
000025e0:  20 3d 20 66 74 65 6c 6c 28 69 6e 29 3b 0a 09 09  = ftell(in);···
000025f0:  09 09 0a 09 09 09 09 66 73 65 65 6b 28 69 6e 2c ·······fseek(in,
00002600:  2d 28 69 25 4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 -(i%NUM_OCT_ROWS
00002610:  29 2c 53 45 45 4b 5f 43 55 52 29 3b 0a 0a 09 09 ),SEEK_CUR);····
00002620:  09 09 75 20 3d 20 30 3b 09 09 09 09 0a 09 09 09 ··u = 0;········
00002630:  09 0a 09 09 09 09 77 68 69 6c 65 20 28 20 0a 09 ······while ( ··
00002640:  09 09 09 09 0a 09 09 09 09 09 75 20 3c 20 28 20 ··········u < ( 
00002650:  69 25 4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 20 29 i%NUM_OCT_ROWS )
00002660:  0a 0a 09 09 09 09 20 20 20 20 20 20 29 0a 09 09 ······      )···
00002670:  09 09 7b 0a 09 09 09 09 09 28 20 63 20 3d 20 66 ··{······( c = f
00002680:  67 65 74 63 28 69 6e 29 20 29 3b 09 0a 09 09 09 getc(in) );·····
00002690:  09 09 0a 09 09 09 09 09 63 6f 6c 6f 72 63 68 61 ········colorcha
000026a0:  72 28 63 29 3b 0a 0a 09 09 09 09 09 69 66 20 28 r(c);·······if (
000026b0:  20 69 73 70 72 69 6e 74 28 63 29 20 29 0a 09 09  isprint(c) )···
000026c0:  09 09 09 7b 09 0a 09 09 09 09 09 09 66 70 75 74 ···{········fput
000026d0:  63 28 63 2c 6f 75 74 29 3b 0a 09 09 09 09 09 7d c(c,out);······}
000026e0:  0a 0a 09 09 09 09 09 65 6c 73 65 0a 09 09 09 09 ·······else·····
000026f0:  09 7b 0a 09 09 09 09 09 09 66 70 72 69 6e 74 66 ·{·······fprintf
00002700:  28 6f 75 74 2c 22 5c 75 30 30 62 37 22 29 3b 0a (out,"\u00b7");·
00002710:  09 09 09 09 09 7d 0a 0a 09 09 09 09 09 75 2b 2b ·····}·······u++
00002720:  3b 0a 0a 09 09 09 09 09 72 65 73 65 74 63 6f 6c ;·······resetcol
00002730:  6f 72 28 29 3b 0a 09 09 09 09 7d 0a 0a 09 09 09 or();·····}·····
00002740:  09 66 73 65 65 6b 28 69 6e 2c 66 70 6f 73 2c 53 ·fseek(in,fpos,S
00002750:  45 45 4b 5f 53 45 54 29 3b 0a 09 09 09 0a 09 7d EEK_SET);······}
00002760:  0a 09 0a 09 65 6c 73 65 20 2f 2f 20 28 20 69 20 ····else // ( i 
00002770:  3d 3d 20 46 49 4c 45 5f 53 49 5a 45 20 26 26 20 == FILE_SIZE && 
00002780:  28 69 25 4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 29 (i%NUM_OCT_ROWS)
00002790:  20 3d 3d 20 30 20 20 29 0a 09 7b 0a 0a 09 09 09  == 0  )··{·····
000027a0:  09 72 73 69 7a 65 5f 74 20 73 70 61 63 65 5f 61 ·rsize_t space_a
000027b0:  6c 69 67 6e 20 3d 20 69 3b 0a 09 09 09 09 0a 09 lign = i;·······
000027c0:  09 09 09 66 70 6f 73 20 3d 20 66 74 65 6c 6c 28 ···fpos = ftell(
000027d0:  69 6e 29 3b 0a 09 09 09 09 0a 09 09 09 09 66 73 in);··········fs
000027e0:  65 65 6b 28 69 6e 2c 2d 28 4e 55 4d 5f 4f 43 54 eek(in,-(NUM_OCT
000027f0:  5f 52 4f 57 53 29 2c 53 45 45 4b 5f 43 55 52 29 _ROWS),SEEK_CUR)
00002800:  3b 0a 0a 09 09 09 09 75 20 3d 20 30 3b 09 09 09 ;······u = 0;···
00002810:  09 0a 09 09 09 09 0a 09 09 09 09 77 68 69 6c 65 ···········while
00002820:  20 28 20 0a 09 09 09 09 09 0a 09 09 09 09 09 75  ( ············u
00002830:  20 3c 20 28 20 4e 55 4d 5f 4f 43 54 5f 52 4f 57  < ( NUM_OCT_ROW
00002840:  53 20 29 0a 0a 09 09 09 09 20 20 20 20 20 20 29 S )······      )
00002850:  0a 09 09 09 09 7b 0a 09 09 09 09 09 28 20 63 20 ·····{······( c 
00002860:  3d 20 66 67 65 74 63 28 69 6e 29 20 29 3b 09 0a = fgetc(in) );··
00002870:  09 09 09 09 09 0a 09 09 09 09 09 63 6f 6c 6f 72 ···········color
00002880:  63 68 61 72 28 63 29 3b 0a 0a 09 09 09 09 09 69 char(c);·······i
00002890:  66 20 28 20 69 73 70 72 69 6e 74 28 63 29 20 29 f ( isprint(c) )
000028a0:  0a 09 09 09 09 09 7b 09 0a 09 09 09 09 09 09 66 ······{········f
000028b0:  70 75 74 63 28 63 2c 6f 75 74 29 3b 0a 09 09 09 putc(c,out);····
000028c0:  09 09 7d 0a 0a 09 09 09 09 09 65 6c 73 65 0a 09 ··}·······else··
000028d0:  09 09 09 09 7b 0a 09 09 09 09 09 09 66 70 72 69 ····{·······fpri
000028e0:  6e 74 66 28 6f 75 74 2c 22 5c 75 30 30 62 37 22 ntf(out,"\u00b7"
000028f0:  29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 09 09 09 );······}·······
00002900:  75 2b 2b 3b 0a 0a 09 09 09 09 09 72 65 73 65 74 u++;·······reset
00002910:  63 6f 6c 6f 72 28 29 3b 0a 09 09 09 09 7d 0a 0a color();·····}··
00002920:  09 09 09 09 66 73 65 65 6b 28 69 6e 2c 66 70 6f ····fseek(in,fpo
00002930:  73 2c 53 45 45 4b 5f 53 45 54 29 3b 0a 09 09 09 s,SEEK_SET);····
00002940:  0a 09 7d 0a 0a 7d 0a 0a 76 6f 69 64 20 70 72 69 ··}··}··void pri
00002950:  6e 74 5f 68 65 78 74 61 62 6c 65 28 46 49 4c 45 nt_hextable(FILE
00002960:  20 2a 20 69 6e 2c 20 46 49 4c 45 20 2a 20 6f 75  * in, FILE * ou
00002970:  74 2c 20 75 6e 73 69 67 6e 65 64 20 63 68 61 72 t, unsigned char
00002980:  20 41 53 43 49 49 5b 5d 2c 20 63 6f 6e 73 74 20  ASCII[], const 
00002990:  72 73 69 7a 65 5f 74 20 46 49 4c 45 5f 53 49 5a rsize_t FILE_SIZ
000029a0:  45 29 0a 7b 0a 09 72 73 69 7a 65 5f 74 20 69 20 E)·{··rsize_t i 
000029b0:  3d 20 30 3b 0a 09 0a 09 72 73 69 7a 65 5f 74 20 = 0;····rsize_t 
000029c0:  75 20 3d 20 30 3b 0a 0a 09 75 6e 73 69 67 6e 65 u = 0;···unsigne
000029d0:  64 20 6c 6f 6e 67 20 66 70 6f 73 20 3d 20 30 3b d long fpos = 0;
000029e0:  0a 0a 09 72 73 69 7a 65 5f 74 20 6a 20 3d 20 30 ···rsize_t j = 0
000029f0:  3b 20 2f 2f 6e 65 65 64 20 74 68 69 73 20 74 6f ; //need this to
00002a00:  20 63 72 65 61 74 65 20 70 72 69 6e 74 61 62 6c  create printabl
00002a10:  65 20 41 53 43 49 49 20 69 6e 20 6f 75 74 70 75 e ASCII in outpu
00002a20:  74 0a 0a 09 75 6e 73 69 67 6e 65 64 20 63 68 61 t···unsigned cha
00002a30:  72 20 63 20 3d 20 30 3b 0a 0a 09 77 68 69 6c 65 r c = 0;···while
00002a40:  20 28 20 69 20 3c 20 46 49 4c 45 5f 53 49 5a 45  ( i < FILE_SIZE
00002a50:  20 29 0a 09 7b 0a 09 09 63 20 3d 20 66 67 65 74  )··{···c = fget
00002a60:  63 28 69 6e 29 3b 0a 0a 09 09 63 6f 6c 6f 72 63 c(in);····colorc
00002a70:  68 61 72 28 63 29 3b 09 0a 23 69 66 20 30 0a 0a har(c);··#if 0··
00002a80:  54 68 69 73 20 70 72 69 6e 74 66 20 61 63 74 75 This printf actu
00002a90:  61 6c 6c 79 20 66 6f 72 63 65 73 20 70 72 69 6e ally forces prin
00002aa0:  74 69 6e 67 20 6f 66 20 41 53 43 49 49 2e 0a 0a ting of ASCII.··
00002ab0:  23 65 6e 64 69 66 09 0a 0a 09 09 69 66 20 28 20 #endif·····if ( 
00002ac0:  69 20 3d 3d 20 30 20 29 0a 09 09 7b 20 66 70 72 i == 0 )···{ fpr
00002ad0:  69 6e 74 66 28 6f 75 74 2c 22 25 30 38 78 3a 25 intf(out,"%08x:%
00002ae0:  63 22 2c 69 2c 30 78 32 30 29 3b 20 7d 0a 0a 0a c",i,0x20); }···
00002af0:  09 09 65 6c 73 65 20 69 66 20 28 20 28 69 25 4e ··else if ( (i%N
00002b00:  55 4d 5f 48 45 58 5f 52 4f 57 53 29 20 3d 3d 20 UM_HEX_ROWS) == 
00002b10:  30 20 20 29 0a 09 09 7b 0a 09 09 09 09 66 70 75 0  )···{·····fpu
00002b20:  74 63 28 30 78 32 30 2c 6f 75 74 29 3b 0a 09 09 tc(0x20,out);···
00002b30:  09 09 0a 09 09 09 09 69 66 20 28 20 69 20 3e 3d ·······if ( i >=
00002b40:  20 4e 55 4d 5f 48 45 58 5f 52 4f 57 53 20 29 0a  NUM_HEX_ROWS )·
00002b50:  09 09 09 09 7b 09 0a 09 09 09 09 0a 09 09 09 09 ····{···········
00002b60:  09 66 73 65 65 6b 28 69 6e 2c 2d 4e 55 4d 5f 48 ·fseek(in,-NUM_H
00002b70:  45 58 5f 52 4f 57 53 2d 31 2c 53 45 45 4b 5f 43 EX_ROWS-1,SEEK_C
00002b80:  55 52 29 3b 0a 0a 09 09 09 09 7d 0a 0a 09 09 09 UR);······}·····
00002b90:  09 65 6c 73 65 0a 09 09 09 09 7b 0a 09 09 09 09 ·else·····{·····
00002ba0:  09 66 73 65 65 6b 28 69 6e 2c 30 2c 53 45 45 4b ·fseek(in,0,SEEK
00002bb0:  5f 53 45 54 29 3b 09 0a 09 09 09 09 7d 0a 0a 09 _SET);······}···
00002bc0:  09 09 09 75 20 3d 20 30 3b 09 09 09 09 0a 09 09 ···u = 0;·······
00002bd0:  09 09 0a 09 09 09 09 77 68 69 6c 65 20 28 20 0a ·······while ( ·
00002be0:  09 09 09 09 09 0a 09 09 09 09 09 75 20 3c 20 4e ···········u < N
00002bf0:  55 4d 5f 48 45 58 5f 52 4f 57 53 0a 0a 09 09 09 UM_HEX_ROWS·····
00002c00:  09 09 09 09 0a 09 09 09 09 20 20 20 20 20 20 29 ·········      )
00002c10:  0a 09 09 09 09 7b 0a 09 09 09 09 09 28 20 63 20 ·····{······( c 
00002c20:  3d 20 66 67 65 74 63 28 69 6e 29 20 29 3b 09 0a = fgetc(in) );··
00002c30:  0a 09 09 09 09 09 63 6f 6c 6f 72 63 68 61 72 28 ······colorchar(
00002c40:  63 29 3b 0a 09 09 09 09 09 0a 09 09 09 09 09 69 c);············i
00002c50:  66 20 28 20 69 73 70 72 69 6e 74 28 63 29 20 29 f ( isprint(c) )
00002c60:  0a 09 09 09 09 09 7b 09 0a 09 09 09 09 09 09 66 ······{········f
00002c70:  70 75 74 63 28 63 2c 6f 75 74 29 3b 0a 09 09 09 putc(c,out);····
00002c80:  09 09 7d 0a 0a 09 09 09 09 09 65 6c 73 65 0a 09 ··}·······else··
00002c90:  09 09 09 09 7b 0a 09 09 09 09 09 09 66 70 72 69 ····{·······fpri
00002ca0:  6e 74 66 28 6f 75 74 2c 22 5c 75 30 30 62 37 22 ntf(out,"\u00b7"
00002cb0:  29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 09 09 09 );······}·······
00002cc0:  75 2b 2b 3b 0a 0a 09 09 09 09 09 72 65 73 65 74 u++;·······reset
00002cd0:  63 6f 6c 6f 72 28 29 3b 0a 09 09 09 09 7d 0a 0a color();·····}··
00002ce0:  09 09 09 09 63 20 3d 20 66 67 65 74 63 28 69 6e ····c = fgetc(in
00002cf0:  29 3b 20 2f 2f 63 61 74 63 68 20 75 70 20 74 6f ); //catch up to
00002d00:  20 6c 61 74 65 73 74 20 72 6f 77 0a 0a 09 09 09  latest row·····
00002d10:  09 63 6f 6c 6f 72 63 68 61 72 28 63 29 3b 0a 09 ·colorchar(c);··
00002d20:  09 09 09 0a 09 09 09 09 66 70 72 69 6e 74 66 28 ········fprintf(
00002d30:  6f 75 74 2c 22 5c 6e 25 30 38 78 3a 25 63 22 2c out,"\n%08x:%c",
00002d40:  69 2c 30 78 32 30 29 3b 0a 09 09 09 09 0a 09 09 i,0x20);········
00002d50:  09 09 72 65 73 65 74 63 6f 6c 6f 72 28 29 3b 09 ··resetcolor();·
00002d60:  0a 09 09 7d 0a 0a 09 09 63 6f 6c 6f 72 63 68 61 ···}····colorcha
00002d70:  72 28 63 29 3b 0a 0a 09 09 0a 09 09 28 69 25 31 r(c);·······(i%1
00002d80:  20 21 3d 20 30 29 20 3f 20 28 20 66 70 72 69 6e  != 0) ? ( fprin
00002d90:  74 66 28 6f 75 74 2c 22 25 30 32 78 22 2c 63 29 tf(out,"%02x",c)
00002da0:  20 29 20 3a 20 28 20 66 70 72 69 6e 74 66 28 6f  ) : ( fprintf(o
00002db0:  75 74 2c 22 25 63 25 30 32 78 22 2c 30 78 32 30 ut,"%c%02x",0x20
00002dc0:  2c 63 29 20 29 3b 0a 09 09 0a 09 09 69 2b 2b 3b ,c) );······i++;
00002dd0:  09 0a 09 09 0a 09 09 72 65 73 65 74 63 6f 6c 6f ·······resetcolo
00002de0:  72 28 29 3b 0a 0a 09 09 2f 2f 20 42 75 67 3a 20 r();····// Bug: 
00002df0:  57 72 69 74 65 20 63 6f 64 65 20 74 6f 20 70 6c Write code to pl
00002e00:  61 63 65 20 66 66 20 61 6e 64 20 65 78 74 72 61 ace ff and extra
00002e10:  20 73 70 61 63 65 73 20 74 6f 20 61 6c 69 67 6e  spaces to align
00002e20:  20 6c 61 73 74 20 41 53 43 49 49 20 6c 69 6e 65  last ASCII line
00002e30:  20 68 65 72 65 0a 09 7d 0a 0a 09 09 69 66 20 28  here··}····if (
00002e40:  20 69 20 3d 3d 20 46 49 4c 45 5f 53 49 5a 45 20  i == FILE_SIZE 
00002e50:  29 0a 09 09 7b 0a 09 09 09 72 73 69 7a 65 5f 74 )···{····rsize_t
00002e60:  20 69 6e 64 65 78 20 3d 20 69 3b 0a 0a 09 09 09  index = i;·····
00002e70:  77 68 69 6c 65 20 28 20 69 6e 64 65 78 20 25 20 while ( index % 
00002e80:  4e 55 4d 5f 48 45 58 5f 52 4f 57 53 20 21 3d 20 NUM_HEX_ROWS != 
00002e90:  30 20 29 20 0a 09 09 09 7b 0a 09 09 09 09 0a 09 0 ) ····{·······
00002ea0:  09 09 09 0a 09 09 09 09 28 69 6e 64 65 78 25 32 ········(index%2
00002eb0:  20 3d 3d 20 30 29 20 0a 09 09 09 09 09 0a 09 09  == 0) ·········
00002ec0:  09 09 09 3f 20 0a 09 09 09 09 09 0a 09 09 09 09 ···? ···········
00002ed0:  09 28 20 66 70 72 69 6e 74 66 28 6f 75 74 2c 22 ·( fprintf(out,"
00002ee0:  25 63 25 63 25 63 22 2c 30 78 32 30 2c 30 78 32 %c%c%c",0x20,0x2
00002ef0:  30 2c 30 78 32 30 29 20 29 20 0a 09 09 09 09 09 0,0x20) ) ······
00002f00:  0a 09 09 09 09 09 3a 20 0a 09 09 09 09 09 0a 09 ······: ········
00002f10:  09 09 09 09 28 20 66 70 72 69 6e 74 66 28 6f 75 ····( fprintf(ou
00002f20:  74 2c 22 25 63 25 63 25 63 22 2c 30 78 32 30 2c t,"%c%c%c",0x20,
00002f30:  30 78 32 30 2c 30 78 32 30 29 20 29 3b 0a 09 09 0x20,0x20) );···
00002f40:  09 09 0a 09 09 09 09 69 6e 64 65 78 2b 2b 3b 0a ·······index++;·
00002f50:  09 09 09 7d 0a 23 69 66 20 30 0a 0a 54 68 69 73 ···}·#if 0··This
00002f60:  20 77 68 69 6c 65 20 6c 6f 6f 70 20 69 73 20 6d  while loop is m
00002f70:  65 61 6e 74 20 66 6f 72 0a 0a 61 20 6c 69 6e 65 eant for··a line
00002f80:  20 74 68 61 74 20 69 73 20 65 71 75 61 6c 20 74  that is equal t
00002f90:  6f 0a 0a 4e 55 4d 5f 48 45 58 5f 52 4f 57 53 0a o··NUM_HEX_ROWS·
00002fa0:  0a 23 65 6e 64 69 66 09 0a 0a 09 09 09 69 66 20 ·#endif······if 
00002fb0:  28 20 69 6e 64 65 78 20 25 20 4e 55 4d 5f 48 45 ( index % NUM_HE
00002fc0:  58 5f 52 4f 57 53 20 3d 3d 20 30 20 29 0a 09 09 X_ROWS == 0 )···
00002fd0:  09 7b 0a 09 09 09 09 66 70 75 74 63 28 30 78 32 ·{·····fputc(0x2
00002fe0:  30 2c 6f 75 74 29 3b 0a 09 09 09 09 0a 09 09 09 0,out);·········
00002ff0:  7d 09 0a 09 0a 09 09 7d 0a 0a 09 0a 0a 09 69 66 }······}······if
00003000:  20 28 20 69 20 3d 3d 20 46 49 4c 45 5f 53 49 5a  ( i == FILE_SIZ
00003010:  45 20 26 26 20 28 69 25 4e 55 4d 5f 48 45 58 5f E && (i%NUM_HEX_
00003020:  52 4f 57 53 29 20 21 3d 20 30 20 20 29 0a 09 7b ROWS) != 0  )··{
00003030:  0a 0a 09 09 09 09 72 73 69 7a 65 5f 74 20 73 70 ······rsize_t sp
00003040:  61 63 65 5f 61 6c 69 67 6e 20 3d 20 69 3b 0a 09 ace_align = i;··
00003050:  09 09 09 0a 09 09 09 09 66 70 6f 73 20 3d 20 66 ········fpos = f
00003060:  74 65 6c 6c 28 69 6e 29 3b 0a 09 09 09 09 0a 09 tell(in);·······
00003070:  09 09 09 66 73 65 65 6b 28 69 6e 2c 2d 28 69 25 ···fseek(in,-(i%
00003080:  4e 55 4d 5f 48 45 58 5f 52 4f 57 53 29 2c 53 45 NUM_HEX_ROWS),SE
00003090:  45 4b 5f 43 55 52 29 3b 0a 0a 09 09 09 09 75 20 EK_CUR);······u 
000030a0:  3d 20 30 3b 09 09 09 09 0a 09 09 09 09 0a 09 09 = 0;············
000030b0:  09 09 77 68 69 6c 65 20 28 20 0a 09 09 09 09 09 ··while ( ······
000030c0:  0a 09 09 09 09 09 75 20 3c 20 28 20 69 25 4e 55 ······u < ( i%NU
000030d0:  4d 5f 48 45 58 5f 52 4f 57 53 20 29 0a 0a 09 09 M_HEX_ROWS )····
000030e0:  09 09 20 20 20 20 20 20 29 0a 09 09 09 09 7b 0a ··      )·····{·
000030f0:  09 09 09 09 09 28 20 63 20 3d 20 66 67 65 74 63 ·····( c = fgetc
00003100:  28 69 6e 29 20 29 3b 09 0a 09 09 09 09 09 0a 09 (in) );·········
00003110:  09 09 09 09 63 6f 6c 6f 72 63 68 61 72 28 63 29 ····colorchar(c)
00003120:  3b 0a 0a 09 09 09 09 09 69 66 20 28 20 69 73 70 ;·······if ( isp
00003130:  72 69 6e 74 28 63 29 20 29 0a 09 09 09 09 09 7b rint(c) )······{
00003140:  09 0a 09 09 09 09 09 09 66 70 75 74 63 28 63 2c ········fputc(c,
00003150:  6f 75 74 29 3b 0a 09 09 09 09 09 7d 0a 0a 09 09 out);······}····
00003160:  09 09 09 65 6c 73 65 0a 09 09 09 09 09 7b 0a 09 ···else······{··
00003170:  09 09 09 09 09 66 70 72 69 6e 74 66 28 6f 75 74 ·····fprintf(out
00003180:  2c 22 5c 75 30 30 62 37 22 29 3b 0a 09 09 09 09 ,"\u00b7");·····
00003190:  09 7d 0a 0a 09 09 09 09 09 75 2b 2b 3b 0a 0a 09 ·}·······u++;···
000031a0:  09 09 09 09 72 65 73 65 74 63 6f 6c 6f 72 28 29 ····resetcolor()
000031b0:  3b 0a 09 09 09 09 7d 0a 0a 09 09 09 09 66 73 65 ;·····}······fse
000031c0:  65 6b 28 69 6e 2c 66 70 6f 73 2c 53 45 45 4b 5f ek(in,fpos,SEEK_
000031d0:  53 45 54 29 3b 0a 09 09 09 0a 09 7d 0a 09 0a 09 SET);······}····
000031e0:  65 6c 73 65 20 2f 2f 20 28 20 69 20 3d 3d 20 46 else // ( i == F
000031f0:  49 4c 45 5f 53 49 5a 45 20 26 26 20 28 69 25 4e ILE_SIZE && (i%N
00003200:  55 4d 5f 48 45 58 5f 52 4f 57 53 29 20 3d 3d 20 UM_HEX_ROWS) == 
00003210:  30 20 20 29 0a 09 7b 0a 0a 09 09 09 09 72 73 69 0  )··{······rsi
00003220:  7a 65 5f 74 20 73 70 61 63 65 5f 61 6c 69 67 6e ze_t space_align
00003230:  20 3d 20 69 3b 0a 09 09 09 09 0a 09 09 09 09 66  = i;··········f
00003240:  70 6f 73 20 3d 20 66 74 65 6c 6c 28 69 6e 29 3b pos = ftell(in);
00003250:  0a 09 09 09 09 0a 09 09 09 09 66 73 65 65 6b 28 ··········fseek(
00003260:  69 6e 2c 2d 28 4e 55 4d 5f 48 45 58 5f 52 4f 57 in,-(NUM_HEX_ROW
00003270:  53 29 2c 53 45 45 4b 5f 43 55 52 29 3b 0a 0a 09 S),SEEK_CUR);···
00003280:  09 09 09 75 20 3d 20 30 3b 09 09 09 09 0a 09 09 ···u = 0;·······
00003290:  09 09 0a 09 09 09 09 77 68 69 6c 65 20 28 20 0a ·······while ( ·
000032a0:  09 09 09 09 09 0a 09 09 09 09 09 75 20 3c 20 28 ···········u < (
000032b0:  20 4e 55 4d 5f 48 45 58 5f 52 4f 57 53 20 29 0a  NUM_HEX_ROWS )·
000032c0:  0a 09 09 09 09 20 20 20 20 20 20 29 0a 09 09 09 ·····      )····
000032d0:  09 7b 0a 09 09 09 09 09 28 20 63 20 3d 20 66 67 ·{······( c = fg
000032e0:  65 74 63 28 69 6e 29 20 29 3b 09 0a 09 09 09 09 etc(in) );······
000032f0:  09 0a 09 09 09 09 09 63 6f 6c 6f 72 63 68 61 72 ·······colorchar
00003300:  28 63 29 3b 0a 0a 09 09 09 09 09 69 66 20 28 20 (c);·······if ( 
00003310:  69 73 70 72 69 6e 74 28 63 29 20 29 0a 09 09 09 isprint(c) )····
00003320:  09 09 7b 09 0a 09 09 09 09 09 09 66 70 75 74 63 ··{········fputc
00003330:  28 63 2c 6f 75 74 29 3b 0a 09 09 09 09 09 7d 0a (c,out);······}·
00003340:  0a 09 09 09 09 09 65 6c 73 65 0a 09 09 09 09 09 ······else······
00003350:  7b 0a 09 09 09 09 09 09 66 70 72 69 6e 74 66 28 {·······fprintf(
00003360:  6f 75 74 2c 22 5c 75 30 30 62 37 22 29 3b 0a 09 out,"\u00b7");··
00003370:  09 09 09 09 7d 0a 0a 09 09 09 09 09 75 2b 2b 3b ····}·······u++;
00003380:  0a 0a 09 09 09 09 09 72 65 73 65 74 63 6f 6c 6f ·······resetcolo
00003390:  72 28 29 3b 0a 09 09 09 09 7d 0a 0a 09 09 09 09 r();·····}······
000033a0:  66 73 65 65 6b 28 69 6e 2c 66 70 6f 73 2c 53 45 fseek(in,fpos,SE
000033b0:  45 4b 5f 53 45 54 29 3b 0a 09 09 09 0a 09 7d 0a EK_SET);······}·
000033c0:  0a 7d 0a 0a 23 69 66 20 30 0a 4c 61 73 74 20 61 ·}··#if 0·Last a
000033d0:  72 67 75 6d 65 6e 74 2c 20 61 72 67 75 6d 65 6e rgument, argumen
000033e0:  74 20 69 6e 64 65 78 0a 0a 61 72 67 63 2d 31 2c t index··argc-1,
000033f0:  20 6d 75 73 74 20 68 61 76 65 20 66 69 6c 65 6e  must have filen
00003400:  61 6d 65 0a 23 65 6e 64 69 66 0a 0a 69 6e 74 20 ame·#endif··int 
00003410:  6d 61 69 6e 28 69 6e 74 20 61 72 67 63 2c 20 63 main(int argc, c
00003420:  68 61 72 20 2a 2a 20 61 72 67 76 29 0a 7b 0a 0a har ** argv)·{··
00003430:  09 46 49 4c 45 20 2a 20 69 6e 20 3d 20 4e 55 4c ·FILE * in = NUL
00003440:  4c 3b 0a 0a 09 46 49 4c 45 20 2a 20 6f 75 74 20 L;···FILE * out 
00003450:  3d 20 73 74 64 6f 75 74 3b 0a 0a 09 69 66 20 28 = stdout;···if (
00003460:  20 61 72 67 63 20 3c 20 32 20 29 0a 09 7b 0a 09  argc < 2 )··{··
00003470:  09 66 70 72 69 6e 74 66 28 69 6e 2c 22 25 6c 6c ·fprintf(in,"%ll
00003480:  75 3a 20 4c 65 73 73 20 74 68 61 6e 20 74 77 6f u: Less than two
00003490:  20 61 72 67 75 6d 65 6e 74 73 21 5c 6e 22 2c 5f  arguments!\n",_
000034a0:  5f 4c 49 4e 45 5f 5f 29 3b 0a 0a 09 09 72 65 74 _LINE__);····ret
000034b0:  75 72 6e 20 31 3b 0a 09 7d 0a 09 0a 09 69 66 20 urn 1;··}····if 
000034c0:  28 20 28 20 28 61 72 67 63 2d 32 29 20 3e 20 30 ( ( (argc-2) > 0
000034d0:  20 29 20 26 26 20 28 20 28 20 69 6e 20 3d 20 66  ) && ( ( in = f
000034e0:  6f 70 65 6e 28 61 72 67 76 5b 61 72 67 63 2d 32 open(argv[argc-2
000034f0:  5d 2c 22 72 62 22 29 20 29 20 21 3d 20 4e 55 4c ],"rb") ) != NUL
00003500:  4c 20 29 20 29 0a 09 7b 0a 09 09 69 66 20 28 20 L ) )··{···if ( 
00003510:  28 20 6f 75 74 20 3d 20 66 6f 70 65 6e 28 61 72 ( out = fopen(ar
00003520:  67 76 5b 61 72 67 63 2d 31 5d 2c 22 77 62 2b 22 gv[argc-1],"wb+"
00003530:  29 20 29 20 3d 3d 20 4e 55 4c 4c 20 29 0a 09 09 ) ) == NULL )···
00003540:  7b 0a 09 09 09 66 70 72 69 6e 74 66 28 73 74 64 {····fprintf(std
00003550:  65 72 72 2c 22 5c 30 33 33 5b 31 3b 33 31 6d 5c err,"\033[1;31m\
00003560:  6e 5c 30 22 29 3b 09 0a 09 09 0a 09 09 09 66 70 n\0");········fp
00003570:  72 69 6e 74 66 28 73 74 64 6f 75 74 2c 22 25 6c rintf(stdout,"%l
00003580:  6c 75 3a 20 46 61 69 6c 65 64 20 74 6f 20 77 72 lu: Failed to wr
00003590:  69 74 65 20 74 6f 20 66 69 6c 65 20 25 73 21 5c ite to file %s!\
000035a0:  6e 22 2c 5f 5f 4c 49 4e 45 5f 5f 2c 61 72 67 76 n",__LINE__,argv
000035b0:  5b 61 72 67 63 2d 31 5d 29 3b 0a 0a 09 09 09 66 [argc-1]);·····f
000035c0:  70 72 69 6e 74 66 28 73 74 64 65 72 72 2c 22 5c printf(stderr,"\
000035d0:  30 33 33 5b 30 6d 5c 6e 5c 30 22 29 3b 0a 0a 09 033[0m\n\0");···
000035e0:  09 09 72 65 74 75 72 6e 20 31 3b 0a 09 09 7d 0a ··return 1;···}·
000035f0:  0a 0a 09 7d 0a 09 0a 09 65 6c 73 65 20 69 66 20 ···}····else if 
00003600:  28 20 28 20 69 6e 20 3d 20 66 6f 70 65 6e 28 61 ( ( in = fopen(a
00003610:  72 67 76 5b 61 72 67 63 2d 31 5d 2c 22 72 62 22 rgv[argc-1],"rb"
00003620:  29 20 29 20 3d 3d 20 4e 55 4c 4c 20 29 0a 09 7b ) ) == NULL )··{
00003630:  0a 09 09 66 70 72 69 6e 74 66 28 73 74 64 65 72 ···fprintf(stder
00003640:  72 2c 22 5c 30 33 33 5b 31 3b 33 31 6d 5c 6e 5c r,"\033[1;31m\n\
00003650:  30 22 29 3b 09 0a 09 09 0a 09 09 66 70 72 69 6e 0");·······fprin
00003660:  74 66 28 73 74 64 6f 75 74 2c 22 25 6c 6c 75 3a tf(stdout,"%llu:
00003670:  20 46 61 69 6c 65 64 20 74 6f 20 6f 70 65 6e 20  Failed to open 
00003680:  66 69 6c 65 21 5c 6e 22 2c 5f 5f 4c 49 4e 45 5f file!\n",__LINE_
00003690:  5f 29 3b 0a 0a 09 09 66 70 72 69 6e 74 66 28 73 _);····fprintf(s
000036a0:  74 64 65 72 72 2c 22 5c 30 33 33 5b 30 6d 5c 6e tderr,"\033[0m\n
000036b0:  5c 30 22 29 3b 0a 0a 09 09 72 65 74 75 72 6e 20 \0");····return 
000036c0:  31 3b 0a 09 7d 0a 09 0a 09 66 73 65 65 6b 28 69 1;··}····fseek(i
000036d0:  6e 2c 30 4c 2c 53 45 45 4b 5f 45 4e 44 29 3b 0a n,0L,SEEK_END);·
000036e0:  0a 09 63 6f 6e 73 74 20 72 73 69 7a 65 5f 74 20 ··const rsize_t 
000036f0:  53 49 5a 45 20 3d 20 66 74 65 6c 6c 28 69 6e 29 SIZE = ftell(in)
00003700:  3b 0a 0a 09 73 74 61 74 69 63 20 75 6e 73 69 67 ;···static unsig
00003710:  6e 65 64 20 63 68 61 72 20 2a 20 61 73 63 69 69 ned char * ascii
00003720:  5f 6c 69 6e 65 3b 20 0a 09 0a 09 61 73 63 69 69 _line; ····ascii
00003730:  5f 6c 69 6e 65 20 3d 20 28 75 6e 73 69 67 6e 65 _line = (unsigne
00003740:  64 20 63 68 61 72 20 2a 29 63 61 6c 6c 6f 63 28 d char *)calloc(
00003750:  4e 55 4d 5f 48 45 58 5f 52 4f 57 53 2b 31 2c 73 NUM_HEX_ROWS+1,s
00003760:  69 7a 65 6f 66 28 75 6e 73 69 67 6e 65 64 20 63 izeof(unsigned c
00003770:  68 61 72 29 29 3b 0a 0a 09 72 65 77 69 6e 64 28 har));···rewind(
00003780:  69 6e 29 3b 0a 0a 09 77 68 69 6c 65 20 28 20 2a in);···while ( *
00003790:  2b 2b 61 72 67 76 20 21 3d 20 4e 55 4c 4c 20 26 ++argv != NULL &
000037a0:  26 20 2a 2a 61 72 67 76 20 3d 3d 20 30 78 32 64 & **argv == 0x2d
000037b0:  20 29 0a 09 7b 0a 09 09 73 77 69 74 63 68 20 28  )··{···switch (
000037c0:  20 2a 2b 2b 28 2a 61 72 67 76 29 20 20 29 0a 09  *++(*argv)  )··
000037d0:  09 7b 0a 09 09 09 0a 09 09 09 63 61 73 65 20 30 ·{········case 0
000037e0:  78 36 33 3a 0a 09 09 09 09 7b 0a 09 09 09 09 09 x63:·····{······
000037f0:  2f 2f 20 67 65 74 20 63 6f 6c 75 6d 6e 20 6e 75 // get column nu
00003800:  6d 62 65 72 0a 0a 09 09 09 09 09 63 68 61 72 20 mber·······char 
00003810:  63 6f 6e 73 74 20 2a 20 63 6f 6c 75 6d 6e 5f 6e const * column_n
00003820:  75 6d 20 3d 20 2a 2b 2b 61 72 67 76 3b 20 0a 0a um = *++argv; ··
00003830:  09 09 09 09 09 77 68 69 6c 65 20 28 20 69 73 64 ·····while ( isd
00003840:  69 67 69 74 28 20 2a 28 2a 61 72 67 76 29 20 29 igit( *(*argv) )
00003850:  20 21 3d 20 30 20 29 0a 09 09 09 09 09 7b 09 28  != 0 )······{·(
00003860:  2a 61 72 67 76 29 2b 2b 3b 09 7d 0a 0a 09 09 09 *argv)++;·}·····
00003870:  09 09 69 66 20 28 20 2a 2a 61 72 67 76 20 21 3d ··if ( **argv !=
00003880:  20 30 78 30 20 29 0a 09 09 09 09 09 7b 0a 09 09  0x0 )······{···
00003890:  09 09 09 09 0a 09 09 09 09 09 09 66 70 72 69 6e ···········fprin
000038a0:  74 66 28 73 74 64 65 72 72 2c 22 5c 30 33 33 5b tf(stderr,"\033[
000038b0:  31 3b 33 31 6d 5c 6e 5c 30 22 29 3b 09 0a 0a 09 1;31m\n\0");····
000038c0:  09 09 09 09 09 66 70 72 69 6e 74 66 28 73 74 64 ·····fprintf(std
000038d0:  65 72 72 2c 22 25 6c 6c 75 3a 20 45 72 72 6f 72 err,"%llu: Error
000038e0:  21 20 43 6f 6c 75 6d 6e 22 0a 09 09 09 09 09 09 ! Column"·······
000038f0:  09 09 22 20 61 72 67 75 6d 65 6e 74 20 69 73 20 ··" argument is 
00003900:  6e 6f 74 20 61 22 20 0a 09 09 09 09 09 09 09 09 not a" ·········
00003910:  22 20 74 79 70 65 20 6f 66 20 75 6e 73 69 67 6e " type of unsign
00003920:  65 64 22 0a 09 09 09 09 09 09 09 09 22 20 69 6e ed"·········" in
00003930:  74 65 67 65 72 21 5c 6e 22 2c 0a 09 09 09 09 09 teger!\n",······
00003940:  09 20 20 20 20 20 20 20 20 5f 5f 4c 49 4e 45 5f ·        __LINE_
00003950:  5f 0a 09 09 09 09 09 09 20 20 20 20 20 20 20 29 _·······       )
00003960:  3b 0a 0a 09 09 09 09 09 09 66 70 72 69 6e 74 66 ;········fprintf
00003970:  28 73 74 64 65 72 72 2c 22 5c 30 33 33 5b 30 6d (stderr,"\033[0m
00003980:  5c 6e 5c 30 22 29 3b 0a 0a 09 09 09 09 09 09 72 \n\0");········r
00003990:  65 74 75 72 6e 20 31 3b 0a 09 09 09 09 09 7d 0a eturn 1;······}·
000039a0:  0a 0a 0a 09 09 09 09 09 4e 55 4d 5f 48 45 58 5f ········NUM_HEX_
000039b0:  52 4f 57 53 20 3d 20 28 72 73 69 7a 65 5f 74 29 ROWS = (rsize_t)
000039c0:  73 74 72 74 6f 6c 28 63 6f 6c 75 6d 6e 5f 6e 75 strtol(column_nu
000039d0:  6d 2c 4e 55 4c 4c 2c 31 30 29 3b 0a 0a 09 09 09 m,NULL,10);·····
000039e0:  09 09 66 72 65 65 28 61 73 63 69 69 5f 6c 69 6e ··free(ascii_lin
000039f0:  65 29 3b 0a 0a 09 09 09 09 09 61 73 63 69 69 5f e);·······ascii_
00003a00:  6c 69 6e 65 20 3d 20 28 75 6e 73 69 67 6e 65 64 line = (unsigned
00003a10:  20 63 68 61 72 20 2a 29 63 61 6c 6c 6f 63 28 4e  char *)calloc(N
00003a20:  55 4d 5f 48 45 58 5f 52 4f 57 53 2c 73 69 7a 65 UM_HEX_ROWS,size
00003a30:  6f 66 28 75 6e 73 69 67 6e 65 64 20 63 68 61 72 of(unsigned char
00003a40:  29 29 3b 0a 0a 09 09 09 09 09 4e 55 4d 5f 42 49 ));·······NUM_BI
00003a50:  4e 5f 52 4f 57 53 20 3d 20 28 72 73 69 7a 65 5f N_ROWS = (rsize_
00003a60:  74 29 73 74 72 74 6f 6c 28 63 6f 6c 75 6d 6e 5f t)strtol(column_
00003a70:  6e 75 6d 2c 4e 55 4c 4c 2c 31 30 29 3b 0a 0a 09 num,NULL,10);···
00003a80:  09 09 09 09 4e 55 4d 5f 4f 43 54 5f 52 4f 57 53 ····NUM_OCT_ROWS
00003a90:  20 3d 20 28 72 73 69 7a 65 5f 74 29 73 74 72 74  = (rsize_t)strt
00003aa0:  6f 6c 28 63 6f 6c 75 6d 6e 5f 6e 75 6d 2c 4e 55 ol(column_num,NU
00003ab0:  4c 4c 2c 31 30 29 3b 0a 0a 09 09 09 09 09 4e 55 LL,10);·······NU
00003ac0:  4d 5f 44 45 43 5f 52 4f 57 53 20 3d 20 28 72 73 M_DEC_ROWS = (rs
00003ad0:  69 7a 65 5f 74 29 73 74 72 74 6f 6c 28 63 6f 6c ize_t)strtol(col
00003ae0:  75 6d 6e 5f 6e 75 6d 2c 4e 55 4c 4c 2c 31 30 29 umn_num,NULL,10)
00003af0:  3b 0a 0a 09 09 09 09 09 62 72 65 61 6b 3b 0a 09 ;·······break;··
00003b00:  09 09 09 7d 0a 0a 09 09 09 63 61 73 65 20 30 78 ···}·····case 0x
00003b10:  36 32 3a 0a 09 09 09 09 7b 0a 09 09 09 09 09 62 62:·····{······b
00003b20:  69 6e 74 61 62 6c 65 5f 72 65 71 75 65 73 74 20 intable_request 
00003b30:  3d 20 31 3b 09 0a 0a 09 09 09 09 09 66 72 65 65 = 1;········free
00003b40:  28 61 73 63 69 69 5f 6c 69 6e 65 29 3b 0a 0a 09 (ascii_line);···
00003b50:  09 09 09 09 61 73 63 69 69 5f 6c 69 6e 65 20 3d ····ascii_line =
00003b60:  20 28 75 6e 73 69 67 6e 65 64 20 63 68 61 72 20  (unsigned char 
00003b70:  2a 29 63 61 6c 6c 6f 63 28 4e 55 4d 5f 42 49 4e *)calloc(NUM_BIN
00003b80:  5f 52 4f 57 53 2b 31 2c 73 69 7a 65 6f 66 28 75 _ROWS+1,sizeof(u
00003b90:  6e 73 69 67 6e 65 64 20 63 68 61 72 29 29 3b 0a nsigned char));·
00003ba0:  09 09 09 09 09 0a 09 09 09 09 09 62 72 65 61 6b ···········break
00003bb0:  3b 0a 09 09 09 09 7d 0a 0a 09 09 09 63 61 73 65 ;·····}·····case
00003bc0:  20 30 78 36 34 3a 0a 09 09 09 09 7b 0a 09 09 09  0x64:·····{····
00003bd0:  09 09 64 65 63 74 61 62 6c 65 5f 72 65 71 75 65 ··dectable_reque
00003be0:  73 74 20 3d 20 31 3b 0a 0a 09 09 09 09 09 66 72 st = 1;·······fr
00003bf0:  65 65 28 61 73 63 69 69 5f 6c 69 6e 65 29 3b 09 ee(ascii_line);·
00003c00:  09 09 09 09 0a 09 09 09 09 09 61 73 63 69 69 5f ··········ascii_
00003c10:  6c 69 6e 65 20 3d 20 28 75 6e 73 69 67 6e 65 64 line = (unsigned
00003c20:  20 63 68 61 72 20 2a 29 63 61 6c 6c 6f 63 28 4e  char *)calloc(N
00003c30:  55 4d 5f 44 45 43 5f 52 4f 57 53 2b 31 2c 73 69 UM_DEC_ROWS+1,si
00003c40:  7a 65 6f 66 28 75 6e 73 69 67 6e 65 64 20 63 68 zeof(unsigned ch
00003c50:  61 72 29 29 3b 0a 0a 09 09 09 09 09 62 72 65 61 ar));·······brea
00003c60:  6b 3b 0a 09 09 09 09 7d 0a 09 09 09 0a 09 09 09 k;·····}········
00003c70:  63 61 73 65 20 30 78 36 66 3a 20 0a 09 09 09 09 case 0x6f: ·····
00003c80:  7b 0a 09 09 09 09 09 6f 63 74 74 61 62 6c 65 5f {······octtable_
00003c90:  72 65 71 75 65 73 74 20 3d 20 31 3b 09 0a 09 09 request = 1;····
00003ca0:  09 09 09 0a 09 09 09 09 09 66 72 65 65 28 61 73 ·········free(as
00003cb0:  63 69 69 5f 6c 69 6e 65 29 3b 0a 09 09 09 09 09 cii_line);······
00003cc0:  0a 09 09 09 09 09 61 73 63 69 69 5f 6c 69 6e 65 ······ascii_line
00003cd0:  20 3d 20 28 75 6e 73 69 67 6e 65 64 20 63 68 61  = (unsigned cha
00003ce0:  72 20 2a 29 63 61 6c 6c 6f 63 28 4e 55 4d 5f 4f r *)calloc(NUM_O
00003cf0:  43 54 5f 52 4f 57 53 2b 31 2c 73 69 7a 65 6f 66 CT_ROWS+1,sizeof
00003d00:  28 75 6e 73 69 67 6e 65 64 20 63 68 61 72 29 29 (unsigned char))
00003d10:  3b 0a 0a 09 09 09 09 09 62 72 65 61 6b 3b 0a 09 ;·······break;··
00003d20:  09 09 09 7d 09 0a 0a 09 09 09 63 61 73 65 20 30 ···}······case 0
00003d30:  78 37 30 3a 0a 09 09 09 09 7b 0a 09 09 09 09 09 x70:·····{······
00003d40:  70 72 69 6e 74 76 69 65 77 28 69 6e 2c 6f 75 74 printview(in,out
00003d50:  2c 53 49 5a 45 29 3b 0a 0a 09 09 09 09 09 72 65 ,SIZE);·······re
00003d60:  74 75 72 6e 20 30 3b 0a 0a 09 09 09 09 7d 0a 09 turn 0;······}··
00003d70:  09 09 0a 0a 0a 0a 09 09 09 64 65 66 61 75 6c 74 ·········default
00003d80:  3a 0a 09 09 09 09 7b 0a 09 09 09 09 09 62 72 65 :·····{······bre
00003d90:  61 6b 3b 0a 09 09 09 09 7d 0a 09 09 7d 09 0a 0a ak;·····}···}···
00003da0:  09 7d 0a 0a 09 69 66 20 28 20 64 65 63 74 61 62 ·}···if ( dectab
00003db0:  6c 65 5f 72 65 71 75 65 73 74 20 3d 3d 20 31 20 le_request == 1 
00003dc0:  29 0a 09 7b 0a 09 09 70 72 69 6e 74 5f 64 65 63 )··{···print_dec
00003dd0:  74 61 62 6c 65 28 69 6e 2c 6f 75 74 2c 61 73 63 table(in,out,asc
00003de0:  69 69 5f 6c 69 6e 65 2c 53 49 5a 45 29 3b 0a 09 ii_line,SIZE);··
00003df0:  7d 0a 0a 09 65 6c 73 65 20 69 66 20 28 20 6f 63 }···else if ( oc
00003e00:  74 74 61 62 6c 65 5f 72 65 71 75 65 73 74 20 3d ttable_request =
00003e10:  3d 20 31 20 29 0a 09 7b 0a 09 09 70 72 69 6e 74 = 1 )··{···print
00003e20:  5f 6f 63 74 74 61 62 6c 65 28 69 6e 2c 6f 75 74 _octtable(in,out
00003e30:  2c 61 73 63 69 69 5f 6c 69 6e 65 2c 53 49 5a 45 ,ascii_line,SIZE
00003e40:  29 3b 0a 09 7d 09 0a 09 0a 09 65 6c 73 65 20 69 );··}·····else i
00003e50:  66 20 28 20 62 69 6e 74 61 62 6c 65 5f 72 65 71 f ( bintable_req
00003e60:  75 65 73 74 20 3d 3d 20 31 20 29 0a 09 7b 20 0a uest == 1 )··{ ·
00003e70:  09 09 70 72 69 6e 74 5f 62 69 6e 74 61 62 6c 65 ··print_bintable
00003e80:  32 28 69 6e 2c 6f 75 74 2c 61 73 63 69 69 5f 6c 2(in,out,ascii_l
00003e90:  69 6e 65 2c 53 49 5a 45 29 3b 0a 09 7d 0a 0a 09 ine,SIZE);··}···
00003ea0:  65 6c 73 65 0a 09 7b 0a 09 09 70 72 69 6e 74 5f else··{···print_
00003eb0:  68 65 78 74 61 62 6c 65 28 69 6e 2c 6f 75 74 2c hextable(in,out,
00003ec0:  61 73 63 69 69 5f 6c 69 6e 65 2c 53 49 5a 45 29 ascii_line,SIZE)
00003ed0:  3b 0a 09 7d 0a 0a 09 69 66 20 28 20 66 63 6c 6f ;··}···if ( fclo
00003ee0:  73 65 28 69 6e 29 20 3d 3d 20 45 4f 46 20 29 0a se(in) == EOF )·
00003ef0:  09 7b 0a 09 09 66 70 72 69 6e 74 66 28 73 74 64 ·{···fprintf(std
00003f00:  65 72 72 2c 22 5c 30 33 33 5b 31 3b 33 31 6d 5c err,"\033[1;31m\
00003f10:  6e 5c 30 22 29 3b 09 0a 09 09 0a 09 09 66 70 72 n\0");·······fpr
00003f20:  69 6e 74 66 28 73 74 64 65 72 72 2c 22 25 6c 6c intf(stderr,"%ll
00003f30:  75 3a 20 45 72 72 6f 72 21 20 46 61 69 6c 65 64 u: Error! Failed
00003f40:  20 74 6f 20 63 6c 6f 73 65 20 25 73 5c 6e 22 2c  to close %s\n",
00003f50:  5f 5f 4c 49 4e 45 5f 5f 2c 61 72 67 76 5b 61 72 __LINE__,argv[ar
00003f60:  67 63 2d 31 5d 29 3b 0a 0a 09 09 66 70 72 69 6e gc-1]);····fprin
00003f70:  74 66 28 73 74 64 65 72 72 2c 22 5c 30 33 33 5b tf(stderr,"\033[
00003f80:  30 6d 5c 6e 5c 30 22 29 3b 0a 09 09 0a 09 09 72 0m\n\0");······r
00003f90:  65 74 75 72 6e 20 31 3b 0a 09 7d 0a 09 0a 09 69 eturn 1;··}····i
00003fa0:  66 20 28 20 66 63 6c 6f 73 65 28 6f 75 74 29 20 f ( fclose(out) 
00003fb0:  3d 3d 20 45 4f 46 20 29 0a 09 7b 0a 09 09 66 70 == EOF )··{···fp
00003fc0:  72 69 6e 74 66 28 73 74 64 65 72 72 2c 22 5c 30 rintf(stderr,"\0
00003fd0:  33 33 5b 31 3b 33 31 6d 5c 6e 5c 30 22 29 3b 09 33[1;31m\n\0");·
00003fe0:  0a 09 09 0a 09 09 66 70 72 69 6e 74 66 28 73 74 ······fprintf(st
00003ff0:  64 65 72 72 2c 22 25 6c 6c 75 3a 20 45 72 72 6f derr,"%llu: Erro
00004000:  72 21 20 46 61 69 6c 65 64 20 74 6f 20 63 6c 6f r! Failed to clo
00004010:  73 65 20 25 73 5c 6e 22 2c 5f 5f 4c 49 4e 45 5f se %s\n",__LINE_
00004020:  5f 2c 61 72 67 76 5b 61 72 67 63 2d 31 5d 29 3b _,argv[argc-1]);
00004030:  0a 0a 09 09 66 70 72 69 6e 74 66 28 73 74 64 65 ····fprintf(stde
00004040:  72 72 2c 22 5c 30 33 33 5b 30 6d 5c 6e 5c 30 22 rr,"\033[0m\n\0"
00004050:  29 3b 0a 09 09 0a 09 09 72 65 74 75 72 6e 20 31 );······return 1
00004060:  3b 0a 09 7d 0a 09 0a 0a 09 72 65 74 75 72 6e 20 ;··}·····return 
00004070:  30 3b 0a 7d 0a                                  0;·}·